"use strict";
var $next3Setting={nav_selector:".next3aws-nav-menu",content_selector:".next3aws-content-area",save_form:"form.next3-offload-settings-panel",offloadStatus:!0,init:function(){$next3Setting.actionTab(),$next3Setting.modalPopup(),document.querySelectorAll($next3Setting.nav_selector+' .nav-setting li a[href*="#ntab"]').forEach(function(e){e.removeEventListener("click",$next3Setting.actionTab),e.addEventListener("click",$next3Setting.actionTab)}),document.querySelectorAll('.wp-submenu li a[href*="#ntab"]').forEach(function(e){e.removeEventListener("click",$next3Setting.actionTab),e.addEventListener("click",$next3Setting.actionTab)});var e=document.querySelectorAll($next3Setting.save_form);e.length>0&&e.forEach(e=>{e.removeEventListener("submit",$next3Setting.saveSetting),e.addEventListener("submit",$next3Setting.saveSetting)});var t=document.querySelectorAll("button.next3-offload-target");t.length>0&&t.forEach(e=>{e.removeEventListener("click",$next3Setting.startOffload),e.addEventListener("click",$next3Setting.startOffload)}),"start"==nxaws3.status_offload&&$next3Setting.actionOffload(nxaws3.type_offload,Number(nxaws3.start_offload)),$hJsSelect2.init(".next3offload-select2"),document.querySelectorAll("input[data-next3-target]").forEach(e=>{let t=e.getAttribute("data-next3-target");""!=t.trim()&&document.querySelectorAll(t).forEach(t=>{!0==e.checked?t.classList.remove("next3-closed"):t.classList.add("next3-closed")}),e.addEventListener("click",function(){let e=this,t=e.getAttribute("data-next3-target");""!=t.trim()&&document.querySelectorAll(t).forEach(t=>{!0==e.checked?t.classList.remove("next3-closed"):t.classList.add("next3-closed")})})}),document.querySelectorAll(".delivery-providers > .delivery-provider").forEach(e=>{let t=e.querySelector("input");t&&(!0==t.checked?e.classList.add("checked-provider"):e.classList.remove("checked-provider"),t.addEventListener("click",function(){document.querySelectorAll(".delivery-providers > .delivery-provider, .delivery-providers-data > .delivery-provider-data").forEach(e=>{e.classList.remove("checked-provider")});let e=this.value,t=document.querySelector(".delivery-providers > .provider-"+e);t&&t.classList.add("checked-provider");let a=document.querySelector(".delivery-providers-data > .provider-data-"+e);a&&a.classList.add("checked-provider")}))})},actionTab:function(){setTimeout(function(){var e=window.location.hash.substr(1),e=window.location.hash.replace("#ntab=",""),t=e.split("/"),a=t[0]?t[0]:e,o=t[1]?t[1]:"";if(a){document.querySelectorAll($next3Setting.nav_selector+" .nav-setting li").forEach(function(e){e.classList.remove("active"),e.classList.remove("topa"),e.classList.remove("bottoma")});var n=document.querySelector($next3Setting.nav_selector+' .nav-setting li a[href="#ntab='+a+'"]');if(n&&n.parentElement.classList.add("active"),document.querySelectorAll($next3Setting.content_selector+" .settings-content > div").forEach(function(e){e.classList.remove("active")}),""!=o){var r=document.querySelector($next3Setting.nav_selector+' .nav-setting li a[href="#ntab='+a+"/"+o+'"]');r&&r.parentElement.classList.add("active");var s=document.querySelector($next3Setting.content_selector+" .settings-content > div#"+a+"-"+o);s&&s.classList.add("active")}else{var s=document.querySelector($next3Setting.content_selector+" .settings-content > div#"+a);s&&s.classList.add("active")}let l=document.querySelector($next3Setting.nav_selector+" .nav-setting li.active");l&&(l.previousElementSibling.classList.add("topa"),l.nextElementSibling.classList.add("bottoma"))}},15)},modalPopup:function(){var e=document.querySelector("#next3aws-welcome-video"),t=document.querySelector("#next3aws-welcome-popup-modal"),a=document.querySelector("#next3aws-welcome-modal-overlay");e&&e.querySelectorAll("a.learn-more").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),t.classList.add("nx-show"),a.classList.add("nx-show")})}),t&&t.querySelectorAll("a.nx-close").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),t.classList.remove("nx-show"),a.classList.remove("nx-show")})})},saveSetting:function(e){e.preventDefault();var t=this,a=t.querySelector("button.full-demo");a.innerHTML='<i class="fa fa-spinner fa-spin"></i> Saving',t.classList.add("next3-loading");let o=t.getAttribute("data-type");nJs.ajax({action:nxaws3.ajax_url+"?action=next3_options",method:"POST",header:{"X-WP-Nonce":window.nxaws3.nonce},data:{message:"save settings data",datatype:o,form_data:nJs.serialize(t)}}).onload=function(){if(4==this.readyState&&200==this.status){let e=JSON.parse(this.responseText);e.success||alert(e.data),a.innerHTML="<i></i> Saved";var o=setInterval(function(){a.innerHTML="<i></i> Save Settings",clearInterval(o)},1500);t.classList.remove("next3-loading")}}},startOffload:function(e){e.preventDefault();var t=this;let a=t.getAttribute("data-type");if(!["pause","resume","cancel"].includes(a)&&!confirm("Are you sure, continue this process?"))return;t.setAttribute("style","opacity: 0.4; user-select: none;pointer-events: none;");let o=t.parentElement.querySelector("p.show-process"),n=t.parentElement.querySelector("button.next3-offload-pause"),r=t.parentElement.querySelector("button.next3-offload-cancel");"pause"==a?($next3Setting.offloadStatus=!1,n.setAttribute("data-type","resume"),n.innerHTML="Resume"):"cancel"==a?$next3Setting.offloadStatus=!1:($next3Setting.offloadStatus=!0,n.setAttribute("data-type","pause"),n.innerHTML="Pause"),nJs.ajax({action:window.nxaws3.ajax_url+"?action=next3offload_start",method:"POST",header:{"X-WP-Nonce":window.nxaws3.nonce},data:{message:"starting offload.....",form_type:a}}).onload=function(){if(4==this.readyState&&200==this.status){let e=JSON.parse(this.responseText),s=e.data.messege?e.data.messege:"",l=e.data.total?e.data.total:0,i=e.data.paged?e.data.paged:1,c=e.data.start_type?e.data.start_type:"offload",d=document.querySelector('[data-action="'+c+'"]').querySelector(".next3-offload-bar"),f=d.querySelector(".complate-process");if(0==l&&1!=i&&(nJs.ajax({action:window.nxaws3.ajax_url+"?action=next3offload_start",method:"POST",header:{"X-WP-Nonce":window.nxaws3.nonce},data:{message:"starting offload.....",form_type:a,paged:1}}).onload=function(){4==this.readyState&&200==this.status&&JSON.parse(this.responseText)}),!e.success){t.removeAttribute("style");let p=!!e.data.start_again&&e.data.start_again,u=e.data.start?e.data.start:0;o&&(o.innerHTML=s),!0==p&&$next3Setting.actionOffload(c,Number(u));return}o&&(o.innerHTML=s),document.querySelectorAll(".next3-offload-bar, .next3-offload-pause, .next3-offload-cancel").forEach(e=>{e.classList.remove("nxopen")}),document.querySelectorAll(".next3-offload-action").forEach(e=>{e!=t&&(e.classList.add("nxopen"),e.removeAttribute("style"))}),t.classList.remove("nxopen"),d&&d.classList.add("nxopen"),n&&n.classList.add("nxopen"),r&&r.classList.add("nxopen");let x=e.data.persent?e.data.persent:0;f&&f.setAttribute("style","width:"+x+"%;");let v;(e.data.total?e.data.total:0)<=(e.data.start?e.data.start:0)&&t.removeAttribute("style"),$next3Setting.actionOffload(c,0)}}},actionOffload:function(e,t){let a=document.querySelector('[data-action="'+e+'"]');var o=a.querySelector("button.next3-offload-action");let n=a.querySelector(".next3-offload-bar"),r=n.querySelector(".complate-process"),s=n.querySelector(".next3-progress-process > span"),l=a.querySelector("button.next3-offload-pause"),i=a.querySelector("button.next3-offload-cancel"),c=a.querySelector("p.show-process"),d=document.querySelectorAll(".next3-offload-pie > .offload-data > span"),f=document.querySelectorAll(".next3-offload-pie > .unoffload-data > span"),p=document.querySelectorAll(".next3-offload-pie > .clean-data > span"),u=document.querySelectorAll(".next3-offload-pie > .styles-data > span"),x=document.querySelectorAll(".next3-offload-pie > .scripts-data > span"),v=document.querySelectorAll(".next3-offload-pie > .wpoffload-data > span"),S=document.querySelectorAll(".next3-offload-pie > .compress-data > span"),y=document.querySelectorAll(".next3-offload-pie > .webp-data > span"),h=document.querySelectorAll(".next3-offload-pie-chart");nJs.ajax({action:window.nxaws3.ajax_url+"?action=next3offload_process",method:"POST",header:{"X-WP-Nonce":window.nxaws3.nonce},data:{message:"starting offload.....",form_type:e,step:t}}).onload=function(){if(4==this.readyState&&200==this.status){let t=JSON.parse(this.responseText),a=t.data.messege?t.data.messege:"";if(!t.success){c&&(c.innerHTML=a);return}let g=t.data.persent?t.data.persent:0;r&&r.setAttribute("style","width:"+g+"%;");let m=t.data.txt?t.data.txt:"";s&&(s.innerHTML=m);let L=t.data.total?t.data.total:0,$=t.data.start?t.data.start:0,q=t.data.offload_type?t.data.offload_type:"none";"none"!=q&&L>0&&(nJs.ajax({action:window.nxaws3.ajax_url+"?action=next3offload_start",method:"POST",header:{"X-WP-Nonce":window.nxaws3.nonce},data:{message:"starting offload.....",form_type:q}}).onload=function(){4==this.readyState&&200==this.status&&JSON.parse(this.responseText)}),L<=$&&(o&&(o.removeAttribute("style"),o.classList.add("nxopen")),n&&n.classList.remove("nxopen"),l&&l.classList.remove("nxopen"),i&&i.classList.remove("nxopen"));let b=t.data.offload_data?t.data.offload_data:{};if(b.total){let E=b.total?b.total:0,A=b.offload?b.offload:0,w=b.offload_per?b.offload_per:0;d.length>0&&d.forEach(e=>{e.innerHTML=w+"% ("+A+"/"+E+")"});let T=b.unoffload?b.unoffload:0,k=b.unoffload_per?b.unoffload_per:0;f.length>0&&f.forEach(e=>{e.innerHTML=k+"% ("+T+"/"+E+")"});let H=b.clean?b.clean:0,M=b.clean_per?b.clean_per:0;p.length>0&&p.forEach(e=>{e.innerHTML=M+"% ("+H+"/"+A+")"});let O=b.total_styles?b.total_styles:0,P=b.total_styles_done?b.total_styles_done:0,_=b.styles_per?b.styles_per:0;u.length>0&&u.forEach(e=>{e.innerHTML=_+"% ("+P+"/"+O+")"});let j=b.total_scripts?b.total_scripts:0,N=b.total_scripts_done?b.total_scripts_done:0,W=b.scripts_per?b.scripts_per:0;x.length>0&&x.forEach(e=>{e.innerHTML=W+"% ("+N+"/"+j+")"});let X=b.wpoffload?b.wpoffload:0,D=b.wpoffload_done?b.wpoffload_done:0,z=b.wpoffload_per?b.wpoffload_per:0;v.length>0&&v.forEach(e=>{e.innerHTML=z+"% ("+D+"/"+X+")"});let R=b.total_optimize?b.total_optimize:0,B=b.total_webp_done?b.total_webp_done:0,C=b.total_compress_done?b.total_compress_done:0,F=b.webp_per?b.webp_per:0,G=b.compress_per?b.compress_per:0;S.length>0&&S.forEach(e=>{e.innerHTML=G+"% ("+C+"/"+R+")"}),y.length>0&&y.forEach(e=>{e.innerHTML=F+"% ("+B+"/"+R+")"}),h.length>0&&h.forEach(e=>{e.setAttribute("style","background:conic-gradient(#165edd "+w+"%, #8d8d91 "+w+"% "+k+"%);")})}L!=$&&$next3Setting.offloadStatus&&$next3Setting.actionOffload(e,Number($)),c&&(c.innerHTML=a)}}}};$next3Setting.init();