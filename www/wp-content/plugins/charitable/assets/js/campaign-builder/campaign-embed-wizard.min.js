"use strict";var CharitableCampaignEmbedWizard=window.CharitableCampaignEmbedWizard||function(e,a,$){var i={},t={formId:0,isBuilder:!1,lastEmbedSearchPageTerm:""},n={init:function(){$(n.ready),$(a).on("load",(function(){"function"==typeof $.ready.then?$.ready.then(n.load):n.load()}))},ready:function(){wpchar.debug("wizard ready","embed wizard"),n.initVars(),n.events()},load:function(){wpchar.debug("embed wizard load","embed wizard"),wpchar.debug(t,"embed wizard"),t.isBuilder&&n.initialStateToggle(),n.initSelectPagesChoicesJS()},initVars:function(){wpchar.debug("wizard initVars","embed wizard"),(i={$wizardContainer:$("#charitable-admin-campaign-embed-wizard-container"),$wizard:$("#charitable-admin-campaign-embed-wizard"),$contentInitial:$("#charitable-admin-campaign-embed-wizard-content-initial"),$contentSelectPage:$("#charitable-admin-campaign-embed-wizard-content-select-page"),$contentCreatePage:$("#charitable-admin-campaign-embed-wizard-content-create-page"),$sectionBtns:$("#charitable-admin-campaign-embed-wizard-section-btns"),$sectionGo:$("#charitable-admin-campaign-embed-wizard-section-go"),$newPageTitle:$("#charitable-admin-campaign-embed-wizard-new-page-title"),$selectPage:$("#campaign-setting-campaign-embed-wizard-choicesjs-select-pages"),$videoTutorial:$("#charitable-admin-campaign-embed-wizard-tutorial"),$sectionToggles:$("#charitable-admin-campaign-embed-wizard-section-toggles"),$sectionGoBack:$("#charitable-admin-campaign-embed-wizard-section-goback"),$shortcode:$("#charitable-admin-campaign-embed-wizard-shortcode-wrap"),$shortcodeInput:$("#charitable-admin-campaign-embed-wizard-shortcode"),$shortcodeCopy:$("#charitable-admin-campaign-embed-wizard-shortcode-copy")}).$selectPageContainer=i.$selectPage.parents("span.choicesjs-select-wrap"),t.isBuilder="undefined"!=typeof CharitableCampaignBuilder,t.pagesExists=1===i.$wizard.data("pages-exists")},initSelectPagesChoicesJS:function(){if(i.$selectPage.length<=0)return;const e=1===i.$selectPage.data("use_ajax");Charitable.Admin.Builder.CharitableChoicesJS.setup(i.$selectPage[0],{},{action:"campaign_admin_campaign_embed_wizard_search_pages_choicesjs",nonce:e?campaign_admin_campaign_embed_wizard.nonce:null})},events:function(){wpchar.debug("CharitableCampaignEmbedWizard events","embed wizard"),wpchar.debug(i.$wizard,"embed wizard"),i.$wizard.length&&i.$wizard.on("click","button",n.popupButtonsClick).on("click",".tutorial-toggle",n.tutorialToggle).on("click",".shortcode-toggle",n.shortcodeToggle).on("click",".initialstate-toggle",n.initialStateToggle).on("click",".charitable-admin-popup-close",n.closePopup).on("click","#charitable-admin-campaign-embed-wizard-shortcode-copy",n.copyShortcodeToClipboard)},popupButtonsClick:function(e){var a=$(e.target);if(a.length){var t=a.closest("div"),o=a.data("action")||"";switch(i.$contentInitial.hide(),o){case"select-page":i.$newPageTitle.hide(),i.$contentSelectPage.show();break;case"create-page":i.$selectPageContainer.hide(),i.$contentCreatePage.show();break;case"go":if(i.$selectPageContainer.is(":visible")&&""===i.$selectPage.val())return;return a.prop("disabled",!0),void n.saveFormAndRedirect()}t.hide(),t.next().fadeIn(),i.$sectionToggles.hide(),i.$sectionGoBack.fadeIn(),$.each([i.$selectPage,i.$newPageTitle],(function(){this.is(":visible")&&this.trigger("focus")}))}},tutorialToggle:function(e){e.preventDefault(),a.open("https://www.wpcharitable.com/documentation/creating-a-campaign-page/","_blank"),n.closePopup()},shortcodeToggle:function(e){e.preventDefault(),i.$videoTutorial.hide(),i.$shortcodeInput.val('[campaign id="'+t.formId+'"]'),i.$shortcode.toggle()},copyShortcodeToClipboard:function(){$("#charitable-admin-campaign-embed-wizard-shortcode").prop("disabled",!1).select().prop("disabled",!0),e.execCommand("copy");var t=i.$shortcodeCopy.find("i");t.removeClass("fa-files-o").addClass("fa-check"),a.setTimeout((function(){t.removeClass("fa-check").addClass("fa-files-o")}),2500)},initialStateToggle:function(e){e&&e.preventDefault(),i.$contentInitial.show(),i.$contentSelectPage.hide(),i.$contentCreatePage.hide(),i.$selectPageContainer.show(),i.$newPageTitle.show(),i.$sectionBtns.show(),i.$sectionGo.hide()},saveFormAndRedirect:function(){t.isBuilder&&!CharitableCampaignBuilder.formIsSaved()?$.confirm({title:!1,content:charitable_builder.exit_confirm,icon:"fa fa-exclamation-circle",type:"orange",closeIcon:!0,buttons:{confirm:{text:charitable_builder.save_embed,btnClass:"btn-confirm",keys:["enter"],action:function(){CharitableCampaignBuilder.formSave().done(n.embedPageRedirect)}},cancel:{text:charitable_builder.embed,action:function(){CharitableCampaignBuilder.setCloseConfirmation(!1),n.embedPageRedirect()}}},onClose:function(){i.$sectionGo.find("button").prop("disabled",!1)}}):n.embedPageRedirect()},embedPageRedirectAjaxData:function(){var e={action:"campaign_admin_campaign_embed_wizard_embed_page_url",_wpnonce:campaign_admin_campaign_embed_wizard.nonce,formId:t.formId};return i.$selectPageContainer.is(":visible")&&(e.pageId=i.$selectPage.val()),i.$newPageTitle.is(":visible")&&(e.pageTitle=i.$newPageTitle.val()),e},embedPageRedirect:function(){var e=n.embedPageRedirectAjaxData();void 0!==e.pageId&&""===e.pageId||$.post(ajaxurl,e,(function(e){e.success&&(a.open(e.data,"_blank"),n.closePopup())}))},openPopup:function(e){e=e||0,wpchar.debug("openPopup opening with "+e,"embed wizard"),t.formId=t.isBuilder?$("#charitable-builder-form").data("id"):e,i.$sectionBtns.show(),i.$sectionGo.hide(),i.$newPageTitle.show(),i.$selectPageContainer.show(),i.$wizardContainer.fadeIn()},closePopup:function(){wpchar.debug("closePopup","embed wizard"),wpchar.debug(i.$wizardContainer,"embed wizard"),i.$wizardContainer.fadeOut(),n.initialStateToggle(),$(e).trigger("charitableWizardPopupClose")},initTooltip:function(){if(void 0!==$.fn.tooltipster){var e=$('<span class="charitable-admin-campaign-embed-wizard-dot">&nbsp;</span>'),a=n.isGutenberg(),i=a?".block-editor .edit-post-header":"#wp-content-editor-tools .charitable-insert-form-button",t={content:$("#charitable-admin-campaign-embed-wizard-tooltip-content"),trigger:"custom",interactive:!0,animationDuration:0,delay:0,theme:["tooltipster-default","charitable-admin-campaign-embed-wizard"],side:a?"bottom":"right",distance:3,functionReady:function(e,a){e._$tooltip.on("click","button",(function(){e.close(),$(".charitable-admin-campaign-embed-wizard-dot").remove()})),e.reposition()}};e.insertAfter(i).tooltipster(t).tooltipster("open")}},isGutenberg:function(){return"undefined"!=typeof wp&&Object.prototype.hasOwnProperty.call(wp,"blocks")}};return n}(document,window,jQuery);CharitableCampaignEmbedWizard.init();