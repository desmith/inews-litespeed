var CharitableCampaignBuilder=window.CharitableCampaignBuilder||function(e,a,$){var t,i,l,n={},r=!0,o=!1,d={settings:{spinner:'<i class="charitable-loading-spinner"></i>',spinnerInline:'<i class="charitable-loading-spinner charitable-loading-inline"></i>',tinymceDefaults:{tinymce:{toolbar1:"bold,italic,underline,blockquote,strikethrough,bullist,numlist,alignleft,aligncenter,alignright,undo,redo,link"},quicktags:!0},pagebreakTop:!1,pagebreakBottom:!1,upload_img_modal:!1},init:function(){var e=this;charitable_panel_switch=!0,t=this.settings,$(d.ready),$(a).on("load",(function(){"function"==typeof $.ready.then?$.ready.then(d.load):d.load()})),$(a).on("beforeunload",(function(){if(!e.formIsSaved()&&r)return charitable_builder.are_you_sure_to_close}))},load:function(){wpchar.getQueryString("newcampaign")&&d.formSave(!1);if(CharitableUtils.triggerEvent(i,"CharitableCampaignBuilderReady").isDefaultPrevented())return!1;d.hideLoadingOverlay()},ready:function(){if(d.isVisitedViaBackButton())location.reload();else{if(d.showLoadingOverlay(),t.version="1.8.0",i=$("#charitable-builder"),l=$("#charitable-builder-form"),n.$helpButton=$("#charitable-help"),n.$previewButton=$("#charitable-preview-btn"),n.$viewCampaignButton=$("#charitable-view-btn"),n.$embedButton=$("#charitable-embed"),n.$statusButton=$("#charitable-status-button"),n.$saveButton=$("#charitable-save"),n.$exitButton=$("#charitable-exit"),n.$templateButton=$(".charitable-panel-template-button"),n.$designButton=$(".charitable-panel-design-button"),n.$settingsButton=$(".charitable-panel-settings-button"),n.$marketingButton=$(".charitable-panel-marketing-button"),n.$paymentButton=$(".charitable-panel-payment-button"),n.$noFieldsOptions=$(".charitable-panel-fields .charitable-no-fields-holder .no-fields"),n.$noFieldsPreview=$(".charitable-panel-fields .charitable-no-fields-holder .no-fields-preview"),n.$formPreview=$(".charitable-panel-fields .charitable-preview-wrap"),n.$revisionPreview=$("#charitable-panel-revisions .charitable-panel-content"),n.$focusOutTarget=null,n.$preview=$(".charitable-preview"),n.$panelDesign=$("#charitable-panel-design"),n.$nextFieldId=$("#charitable-field-id"),n.$fieldOptions=$("#charitable-field-options"),n.$fieldsPreviewWrap=$(".charitable-panel-fields .charitable-panel-content-wrap"),n.$sortableFieldsWrap=$(".charitable-panel-fields .charitable-field-wrap"),n.$sortableTabsWrap=$(".charitable-panel-fields .charitable-tab-wrap"),n.$sortableTabNav=$(".charitable-campaign-preview nav.charitable-campaign-preview-nav"),n.$sortableTabContent=$(".charitable-campaign-preview .tab-content"),n.$addFieldsButtons=$(".charitable-add-fields-button").not(".not-draggable").not(".warning-modal").not(".charitable-not-available").not(".charitable-not-installed").not(".charitable-not-activated").not(".charitable-installed-refresh").not(".charitable-addon-file-missing").not(".charitable-need-upgrade"),n.$templatePanel=$("#charitable-panel-template"),n.$templatePreview=$(".charitable-template-preview"),n.$settingsPanel=$("#charitable-panel-settings"),n.$campaignID=$('#charitable-builder-form input[name="id"]'),n.$templateID=$('#charitable-builder-form input[name="template_id"]'),n.$templateLabel=$('#charitable-builder-form input[name="template_label"]'),n.$postStatus=$('#charitable-builder-form input[name="post_status"]'),n.$primaryThemeColorBase=$('#charitable-builder-form input[name="color_base_primary"]'),n.$secondaryThemeColorBase=$('#charitable-builder-form input[name="color_base_secondary"]'),n.$tertiaryThemeColorBase=$('#charitable-builder-form input[name="color_base_tertiary"]'),n.$buttonThemeColorBase=$('#charitable-builder-form input[name="color_base_button"]'),d.bindUIActions(),t.formID=l.data("id"),t.templateID=l.data("template-id"),t.templateLabel=l.data("template-label"),t.primaryThemeColorBase=t.primaryThemeColor=$(this).closest(".charitable-template").data("template-primary"),t.secondaryThemeColorBase=t.secondaryThemeColor=$(this).closest(".charitable-template").data("template-secondary"),t.tertiaryThemeColorBase=t.tertiaryThemeColor=$(this).closest(".charitable-template").data("template-tertiary"),t.buttonThemeColorBase=t.buttonThemeColor=$(this).closest(".charitable-template").data("template-button"),t.primaryThemeColorBase=n.$primaryThemeColorBase.val().length>0?n.$primaryThemeColorBase.val():"",t.secondaryThemeColorBase=n.$secondaryThemeColorBase.val().length>0?n.$secondaryThemeColorBase.val():"",t.tertiaryThemeColorBase=n.$tertiaryThemeColorBase.val().length>0?n.$tertiaryThemeColorBase.val():"",t.buttonThemeColorBase=n.$buttonThemeColorBase.val().length>0?n.$buttonThemeColorBase.val():"",t.primaryThemeColor="",t.secondaryThemeColor="",t.tertiaryThemeColor="",t.buttonThemeColor="",t.formSaved=l.find("#charitable-form-saved").val(),t.formSavedStatus=l.find("#charitable-form-post-status").val(),t.formSavedStatusLabel=l.find("#charitable-form-post-status-label").val(),t.formStatus=t.formSavedStatus.length>0?t.formSavedStatus:"draft",t.formStatusLabel=t.formSavedStatusLabel.length>0?t.formSavedStatusLabel:"Draft",t.campaignTitle=$("input#charitable_settings_title").val(),t.campaignDescription=$('div[data-special-type="campaign_description"] .campaign-builder-htmleditor').first().html(),t.campaignOverview=$('div[data-special-type="campaign_overview"] .campaign-builder-htmleditor').length>0?$('div[data-special-type="campaign_overview"] .campaign-builder-htmleditor').first().html():"",t.maxNumberOfTabs=4,t.denyList={"donation-form":{"donate-button":0,"donation-form":0,"donate-amount":0},"donate-button":{"donation-form":0},"donate-amount":{"donation-form":0}},t.pagebreakTop=$(".charitable-pagebreak-top").length,t.pagebreakBottom=$(".charitable-pagebreak-bottom").length,t.didInitHTMLEditorFields=!1,t.quilled=[],t.currentModal=!1,i.on("keypress","#charitable-builder-form :input:not(textarea)",(function(e){13===e.keyCode&&e.preventDefault()})),$(".charitable-panel").each((function(e,a){var t=$(this),i=t.find(".charitable-panel-sidebar-section.configured").first();if(i.length){var l=i.data("section");i.addClass("active"),t.find(".charitable-panel-content-section-"+l).show().addClass("active"),t.find(".charitable-panel-content-section-default").hide()}else t.find(".charitable-panel-content-section").hide().removeClass("active"),t.find(".charitable-panel-content-section").first().show().addClass("active"),t.find(".charitable-panel-sidebar-section:first-of-type").addClass("active")})),wpchar.initTooltips(),d.builderHotkeys(),"undefined"!=typeof jconfirm&&(jconfirm.defaults={closeIcon:!1,backgroundDismiss:!1,escapeKey:!0,animationBounce:1,useBootstrap:!1,theme:"modern",boxWidth:"400px",animateFromElement:!1,content:charitable_builder.something_went_wrong}),$("#charitable_settings_title").attr("disabled",!0),$(".campaign-builder-datepicker").each((function(){d.initDatePicker($(this))})),$(".campaign-tag-field").each((function(){d.initTagField($(this))})),$(".charitable-campaign-suggested-donations").each((function(){d.initSuggestedDonations($(this))})),$(".charitable-campaign-suggested-donations-mini").each((function(){d.initSuggestedDonationsMini($(this)),d.updateSuggestdDonationsMiniRowsFromSettings($(this))})),d.initColorPicker(),d.initTemplatePanel(),d.initStatusButton(),d.updateGoalRelatedItems(),d.updateEndDateRelatedItems(),d.resizeTopCampaignTitleInputBox(),!1!==d.hasTemplate()){var e=null!==wpCookies.get("charitable_panel")&&wpCookies.get("charitable_panel").trim();void 0!==e&&e.length>0&&"template"!==e?d.panelSwitch(e):d.panelSwitch("design"),d.checkFieldAllow(),d.redirectBasedOnCookies(e)}else d.forceTemplateSelect(),d.disableFormActions(!1);d.openModalButtonClick(),d.confirmCampaignDeletion(),$(".education-buttons button").click((function(){a.open("https://www.wpcharitable.com/pricing/")})),$(".campaign-builder-campaign-creator-id select").select2({templateResult:d.campaignCreatorFormatOptions}),$(".campaign-builder-campaign-creator-id-mini select").select2({templateResult:d.campaignCreatorFormatOptions})}},campaignCreatorFormatOptions:e=>e.id?$('<span class="charitable-select2-avatar"><img width="20px" height="20px" style="display: inline-block; float: left; margin-right: 10px;" src="'+e.element.dataset.avatar+'" /> '+e.text+'</span><span class="charitable-select2-meta"> '+e.element.dataset.meta+"</span>"):e.text,redirectBasedOnCookies(e=!1){var a=wpCookies.get("charitable_panel_content_section"),t=""!==wpCookies.get("charitable_panel_active_field_id")?parseInt(wpCookies.get("charitable_panel_active_field_id")):"",i=wpCookies.get("charitable_panel_tab_section_tab_id"),l=wpCookies.get("charitable_panel_design_layout_options_group");$(".charitable-preview").is(":visible")&&$("ul.charitable-tabs li#layout-options").is(":visible")&&""!==l&&""===t?($("ul.charitable-tabs li#layout-options a").hasClass("active")||$("ul.charitable-tabs li#layout-options a").click(),$("#charitable-field-options div.charitable-layout-options-tab-"+l+" a.charitable-group-toggle").click()):$(".charitable-preview").is(":visible")&&""!==i&&$('nav.charitable-campaign-preview-nav li[data-tab-id="'+i+'"] a').is(":visible")?$('.charitable-preview nav.charitable-campaign-preview-nav li[data-tab-id="'+i+'"] a').click():$(".charitable-preview").is(":visible")&&$("#charitable-field-"+t+" a").is(":visible")?d.clickFieldEdit(t):$(".charitable-panel-sidebar").is(":visible")&&$('a.charitable-panel-sidebar-section[data-section="'+a+'"').is(":visible")?$('a.charitable-panel-sidebar-section[data-section="'+a+'"').click():""!==t&&$("#charitable-field-"+t).is(":visible")?$("#charitable-field-"+t).click():a&&$(".charitable-tabs").is(":visible")&&$(".charitable-tabs li#"+a+" a").is(":visible")?$(".charitable-tabs li#"+a+" a").click():!1===e&&!1!==d.hasTemplate()?d.panelSwitch("design"):wpchar.debug("redirectBasedOnCookies nothing")},clickFieldEdit(e){$("#charitable-field-"+e+" a.charitable-field-edit").click()},refreshTabFieldsSortDrag(){n.$sortableTabContent=$(".charitable-campaign-preview .tab-content")},hasTemplate:()=>void 0!==t.templateID&&t.templateID.length>0||parseInt(n.$templateID.val())>0,forceTemplateSelect(){$("#charitable-panels-toggle").find("button").removeClass("active").addClass("disabled"),n.$templateButton.removeClass("disabled").addClass("active"),d.panelSwitch("template")},unforceTemplateSelect(){$("#charitable-panels-toggle").find("button").removeClass("disabled")},disableTemplateSelect(){n.$templateButton.removeClass("active").addClass("disabled")},updateTemplateID(e="",a=""){n.$templateID.val(e),n.$templateLabel.val(a),d.updateThemeCSS(null,e,t.primaryThemeColor,t.secondaryThemeColor,t.tertiaryThemeColor,t.buttonThemeColor,!1),$(".charitable-preview").removeClass((function(e,a){return(a.match(/(^|\s)charitable-builder-template-\S+/g)||[]).join(" ")})).addClass("charitable-builder-template-"+e),""!==a?$(".charitable-preview-top-bar .charitable-campaign-theme-label").text(a):""!==e&&$(".charitable-preview-top-bar .charitable-campaign-theme-label").text(e)},updateThemeCSS(e=null,a="",i="",l="",n="",r="",o=!0){if(""!==a||""!==t.templateID){void 0!==t.primaryThemeColor&&""!==i||(i=void 0!==t.primaryThemeColor&&""!==t.primaryThemeColor?t.primaryThemeColor:void 0!==t.primaryThemeColorBase&&""!==t.primaryThemeColorBase?t.primaryThemeColorBase:"000000"),void 0!==t.secondaryThemeColor&&""!==l||(l=void 0!==t.secondaryThemeColor&&""!==t.secondaryThemeColor?t.secondaryThemeColor:void 0!==t.secondaryThemeColorBase&&""!==t.secondaryThemeColorBase?t.secondaryThemeColorBase:"000000"),void 0!==t.tertiaryThemeColor&&""!==n||(n=void 0!==t.tertiaryThemeColor&&""!==t.tertiaryThemeColor?t.tertiaryThemeColor:void 0!==t.tertiaryThemeColorBase&&""!==t.tertiaryThemeColorBase?t.tertiaryThemeColorBase:"000000"),void 0!==t.buttonThemeColor&&""!==r||(r=void 0!==t.buttonThemeColor&&""!==t.buttonThemeColor?t.buttonThemeColor:void 0!==t.buttonThemeColorBase&&""!==t.buttonThemeColorBase?t.buttonThemeColorBase:"000000");var c="p="+(i=i.replace(/[^a-zA-Z 0-9]+/g,""))+"&s="+(l=l.replace(/[^a-zA-Z 0-9]+/g,""))+"&t="+(n=n.replace(/[^a-zA-Z 0-9]+/g,""))+"&b="+(r=r.replace(/[^a-zA-Z 0-9]+/g,""))+"&ver="+t.version;!1===o&&$('link[id="charitable-builder-template-preview-theme-css"]').attr("href",charitable_builder.charitable_assets_dir+"css/campaign-builder/themes/admin/"+a+".php?"+c),null!==e?d.replaceCSSFile(e,a,c):(d.replaceCSSFile("primary",a,c),d.replaceCSSFile("secondary",a,c),d.replaceCSSFile("tertiary",a,c),d.replaceCSSFile("button",a,c))}},replaceCSSFile:function(e,a,t){$("head").find("link#charitable-builder-template-preview-theme-colors-"+e+"-css").remove(),$("head").append('<link rel="stylesheet" data-color-type="'+e+'" id="charitable-builder-template-preview-theme-colors-temp" href="'+charitable_builder.charitable_assets_dir+"css/campaign-builder/themes/admin/"+a+"-colors.php?"+t+'" type="text/css" media="screen">'),$("#charitable-design-wrap").addClass("loading"),setTimeout((function(){$("head").find("#charitable-builder-template-preview-theme-colors-temp").attr("id","charitable-builder-template-preview-theme-colors-"+e+"-css"),$("#charitable-design-wrap").removeClass("loading")}),250)},searchTemplate:function(e){e.preventDefault();let a=$(".charitable-setup-templates-categories li.active").data("category"),t=$(this).val();d.performSearch(t,a)},performSearch(e="",a=""){let t=n.$templatePreview.find(".charitable-template-list");""!==e||""!==a&&"all"!==a?(t.find(".charitable-template-list-container-item").addClass("charitable-hidden"),""!==e&&""!==a&&"all"!==a?t.find('.charitable-template[data-template-tags*="'+e+'"][data-template-categories*="'+a+'"]').parent().removeClass("charitable-hidden"):""===e||""!==a&&"all"!==a?t.find('.charitable-template[data-template-tags*="'+a+'"],.charitable-template[data-template-categories*="'+a+'"]').parent().removeClass("charitable-hidden"):t.find('.charitable-template[data-template-tags*="'+e+'"],.charitable-template[data-template-categories*="'+e+'"]').parent().removeClass("charitable-hidden")):t.find(".charitable-template-list-container-item").removeClass("charitable-hidden");var i=$(".charitable-template-list-container-item").not(".hidden").length;$(".charitable-templates-no-results").toggle(!i),n.$templatePreview.find("#charitable-setup-template-search").val()?n.$templatePreview.find(".charitable-setup-templates-search-wrap .fa-close").show():n.$templatePreview.find(".charitable-setup-templates-search-wrap .fa-close").hide(),d.showUpgradeBanner()},selectCategory:function(e){e.preventDefault();let a=$(this),t=a.closest("ul").find(".active"),i=a.data("category"),l=$("#charitable-setup-template-search").val();t.removeClass("active"),a.addClass("active"),d.performSearch(l,i)},showUpgradeBanner:function(){if(!$("#tmpl-charitable-templates-upgrade-banner").length)return;if($("#charitable-template-list .charitable-template-upgrade-banner").length>0&&$("#charitable-template-list .charitable-template-upgrade-banner").remove(),!d.isFunction(wp.template))return void wpchar.debug("wp.template not a function");wpchar.debug("wp.template is a function");let e=wp.template("charitable-templates-upgrade-banner");if(!e)return;const a=$("#charitable-template-list .charitable-template-list-container-item:not(.charitable-hidden)"),t=$("#charitable-template-list .charitable-template-list-container-item");a.length>5?$("#charitable-template-list .charitable-template-list-container > div:eq(5)").after(e()):t.last().after(e())},initStatusButton:function(e="",a=""){var i=$("ul#charitable-status-dropdown");""==e&&t.formStatus.length>0&&(e=t.formStatus),""==a&&t.formStatusLabel.length>0&&(a=t.formStatusLabel),i.addClass("charitable-hidden"),$("#charitable-status-button").removeClass("active"),$("#charitable-status-button span.text").html(a),$("#charitable-status-button").attr("data-status",e),i.find("a").removeClass("charitable-hidden"),i.find("a.switch-"+e).addClass("charitable-hidden"),i.find("a."+e).addClass("charitable-hidden")},initTemplatePanel:function(){$("#charitable-template-container").on("keyup","#charitable-setup-template-search",d.searchTemplate).on("click",".charitable-setup-templates-categories li",d.selectCategory),t.didInitHTMLEditorFields||($(".campaign-builder-htmleditor").each((function(){d.initHTMLEditorFields($(this))})),$(".campaign-builder-htmleditor-min").each((function(){d.initHTMLEditorFields($(this),!0)})),t.didInitHTMLEditorFields=!0),n.$templatePreview.on("click",".charitable-template-lite-to-pro a.button, .charitable-setup-desc.secondary-text a.send-feedback",(function(e){e.preventDefault(),$(".charitable-panel-content-wrap").animate({scrollTop:0},500),$(".charitable-template-list-container").addClass("disabled"),$(".charitable-feedback-form-container").after('<div id="charitable-builder-underlay" class="charitable-builder-underlay"></div>'),$(".charitable-feedback-form-container").css("opacity","100").css("visibility","visible"),$(".charitable-feedback-form-container").find(".charitable-feedback-form-interior").removeClass("charitable-hidden"),$(".charitable-feedback-form-container").find("textarea").val(""),$(".charitable-feedback-form-interior-confirmation").addClass("charitable-hidden")})),l.on("click","#charitable-feedback-form .charitable-templates-close-icon, #charitable-feedback-form-confirmation .charitable-templates-close-icon",(function(e){e.preventDefault(),$(".charitable-template-list-container").removeClass("disabled"),$(".charitable-builder-underlay").remove(),$("#charitable-panel-template .charitable-feedback-form-container").css("opacity","0").css("visibility","hidden")})),l.on("click",".template-buttons a.preview-campaign",(function(e){e.preventDefault(),$(".charitable-template-list-container").addClass("disabled"),$(".charitable-feedback-form-container").after('<div id="charitable-builder-underlay" class="charitable-builder-underlay"></div>');const a=$(this).closest(".charitable-template"),t=void 0!==a.data("template-label")?a.data("template-label"):"",i=void 0!==a.data("template-description")?a.data("template-description"):"",l=void 0!==a.data("template-preview-url")?a.data("template-preview-url"):"",n=void 0!==a.data("template-code")?a.data("template-code"):"";$("#charitable-builder-modal-template-preview").find("h4").html(t),$("#charitable-builder-modal-template-preview").find(".charitable-templates-preview-description").html("<p>"+i+"</p>"),$("#charitable-builder-modal-template-preview").find("img").attr("src",l),$("#charitable-builder-modal-template-preview").find("img").attr("alt",t),$("#charitable-builder-modal-template-preview").find("a.button-link").attr("data-template-id",n),$(".charitable-builder-modal.charitable-builder-modal-template-preview").addClass("active")})),l.on("click","#charitable-templates-preview-form .charitable-templates-close-icon",(function(e){e.preventDefault(),$(".charitable-template-list-container").removeClass("disabled"),$("#charitable-builder-underlay").remove(),$(".charitable-builder-modal.charitable-builder-modal-template-preview").removeClass("active")})),n.$templatePreview.on("click","nav.charitable-template-tabs a",(function(e){e.preventDefault();var a=$(this),t=!!a.data("template-tab-filter")&&a.data("template-tab-filter"),i=n.$templatePreview.find(".charitable-template-list ");n.$templatePreview.find("nav.charitable-template-tabs a").removeClass("active"),a.addClass("active"),i.find(".charitable-template").removeClass("hidden"),t&&i.find('.charitable-template[data-template-type!="'+t+'"]').addClass("hidden")})),n.$templatePreview.on("click","a.charitable-trigger-blank",(function(e){e.preventDefault(),$("#charitable-template-list .charitable-template-upgrade-banner").remove(),n.$templatePreview.find("#charitable-setup-template-search").val("simple").trigger("keyup").addClass("highlighted").addClass("with-x"),n.$templatePreview.find(".charitable-setup-templates-categories").find("li[data-category=all").click(),d.showUpgradeBanner()})),n.$templatePreview.on("click","i.fa-close",(function(e){n.$templatePreview.find("#charitable-setup-template-search").val("").trigger("keyup").removeClass("highlighted")})),n.$templatePreview.on("click",".button.create-campaign",(function(a){a.preventDefault(),d.hasTemplate()?$.confirm({title:charitable_builder.heads_up,content:"<p>"+charitable_builder.error_already_started_campaign+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){t.templateID=$(this).closest(".charitable-template").data("template-code"),t.templateLabel=$(this).closest(".charitable-template").data("template-label"),t.primaryThemeColorBase=t.primaryThemeColor=$(this).closest(".charitable-template").data("template-primary"),t.secondaryThemeColorBase=t.secondaryThemeColor=$(this).closest(".charitable-template").data("template-secondary"),t.tertiaryThemeColorBase=t.tertiaryThemeColor=$(this).closest(".charitable-template").data("template-tertiary"),t.buttonThemeColorBase=t.buttonThemeColor=$(this).closest(".charitable-template").data("template-button"),n.$primaryThemeColorBase.val(t.primaryThemeColorBase),n.$secondaryThemeColorBase.val(t.secondaryThemeColorBase),n.$tertiaryThemeColorBase.val(t.tertiaryThemeColorBase),n.$buttonThemeColorBase.val(t.buttonThemeColorBase),$('input[name="layout__advanced__theme_color_primary"]').val(t.primaryThemeColor),$('input[name="layout__advanced__theme_color_secondary"]').val(t.secondaryThemeColor),$('input[name="layout__advanced__theme_color_tertiary"]').val(t.tertiaryThemeColor),$('input[name="layout__advanced__theme_color_button"]').val(t.buttonThemeColor),e.querySelector('input[name="layout__advanced__theme_color_primary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_secondary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_tertiary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_button"]').dispatchEvent(new Event("input",{bubbles:!0})),d.restartForm(t.templateID,null,t.templateLabel),d.restartTemplateScreen(t.templateID)}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}}):(t.templateID=$(this).closest(".charitable-template").data("template-code"),t.templateLabel=$(this).closest(".charitable-template").data("template-label"),t.primaryThemeColorBase=t.primaryThemeColor=$(this).closest(".charitable-template").data("template-primary"),t.secondaryThemeColorBase=t.secondaryThemeColor=$(this).closest(".charitable-template").data("template-secondary"),t.tertiaryThemeColorBase=t.tertiaryThemeColor=$(this).closest(".charitable-template").data("template-tertiary"),t.buttonThemeColorBase=t.buttonThemeColor=$(this).closest(".charitable-template").data("template-button"),n.$primaryThemeColorBase.val(t.primaryThemeColorBase),n.$secondaryThemeColorBase.val(t.secondaryThemeColorBase),n.$tertiaryThemeColorBase.val(t.tertiaryThemeColorBase),n.$buttonThemeColorBase.val(t.buttonThemeColorBase),$('input[name="layout__advanced__theme_color_primary"]').val(t.primaryThemeColor),$('input[name="layout__advanced__theme_color_secondary"]').val(t.secondaryThemeColor),$('input[name="layout__advanced__theme_color_tertiary"]').val(t.tertiaryThemeColor),$('input[name="layout__advanced__theme_color_button"]').val(t.buttonThemeColor),e.querySelector('input[name="layout__advanced__theme_color_primary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_secondary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_tertiary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_button"]').dispatchEvent(new Event("input",{bubbles:!0})),d.updateTemplateID(t.templateID,t.templateLabel),d.unforceTemplateSelect(),d.enableFormActions(),d.restartForm(t.templateID,"design",t.templateLabel),d.restartTemplateScreen(t.templateID),t.didInitHTMLEditorFields||($(".campaign-builder-htmleditor").each((function(){d.initHTMLEditorFields($(this))})),$(".campaign-builder-htmleditor-min").each((function(){d.initHTMLEditorFields($(this),!0)})),t.didInitHTMLEditorFields=!0))})),i.on("click",".button-preview-create-campaign",(function(e){e.preventDefault();var a=$(this).data("template-id");""!==a&&($(".charitable-template-list-container").removeClass("disabled"),$("#charitable-builder-underlay").remove(),$(".charitable-builder-modal.charitable-builder-modal-template-preview").removeClass("active"),n.$templatePreview.find(".charitable-template-list-container-item.charitable-template-"+a+" .button.create-campaign").click())})),n.$templatePreview.on("click",".button.update-campaign",(function(a){a.preventDefault();var i=$(this);d.hasTemplate()&&$.confirm({title:charitable_builder.heads_up,content:"<p>"+charitable_builder.error_already_started_campaign+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){t.templateID=i.closest(".charitable-template").data("template-code"),t.templateLabel=i.closest(".charitable-template").data("template-label"),d.updateTemplateID(t.templateID,t.templateLabel),t.primaryThemeColorBase=t.primaryThemeColor=i.closest(".charitable-template").data("template-primary"),t.secondaryThemeColorBase=t.secondaryThemeColor=i.closest(".charitable-template").data("template-secondary"),t.tertiaryThemeColorBase=t.tertiaryThemeColor=i.closest(".charitable-template").data("template-tertiary"),t.buttonThemeColorBase=t.buttonThemeColor=i.closest(".charitable-template").data("template-button"),n.$primaryThemeColorBase.val(t.primaryThemeColorBase),n.$secondaryThemeColorBase.val(t.secondaryThemeColorBase),n.$tertiaryThemeColorBase.val(t.tertiaryThemeColorBase),n.$buttonThemeColorBase.val(t.buttonThemeColorBase),$('input[name="layout__advanced__theme_color_primary"]').val(t.primaryThemeColor),$('input[name="layout__advanced__theme_color_secondary"]').val(t.secondaryThemeColor),$('input[name="layout__advanced__theme_color_tertiary"]').val(t.tertiaryThemeColor),$('input[name="layout__advanced__theme_color_button"]').val(t.buttonThemeColor),e.querySelector('input[name="layout__advanced__theme_color_primary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_secondary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_tertiary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_button"]').dispatchEvent(new Event("input",{bubbles:!0})),$("#charitable-template-list .charitable-template").removeClass("active"),$("#charitable-template-list .charitable-banner-container").each((function(){$(this).addClass("charitable-hidden"),$(this).parent().find(".template-buttons").removeClass("charitable-hidden")})),i.closest(".charitable-template").addClass("active"),i.closest(".charitable-template").find(".template-buttons").addClass("chartiable-hidden"),i.closest(".charitable-template").find(".charitable-banner-container").removeClass("charitable-hidden"),$(".charitable-setup-desc.secondary-text strong.template-name").html(t.templateLabel),wpchar.debug("chose this path"),d.restartForm(t.templateID,"design",t.templateLabel),d.restartTemplateScreen(t.templateID)}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})})),d.showUpgradeBanner()},restartTemplateScreen:function(e=0){if(""!==e&&0!==e||(e=t.templateID),""===e||0===e)return;const a=$(".charitable-template-list-container");a.find(".template-buttons").remove(".preview-campaign"),a.find(".button.create-campaign").removeClass("create-campaign").addClass("update-campaign").html(charitable_builder.update_campaign),a.find(".charitable-template").removeClass("active"),a.find(".charitable-template .charitable-banner-container").addClass("charitable-hidden"),a.find('.charitable-template[data-template-code="'+e+'"]').addClass("active"),a.find('.charitable-template[data-template-code="'+e+'"] .charitable-banner-container').removeClass("charitable-hidden")},restartForm:function(e=0,a="design",i=!1){d.updateTemplateID(e,i),d.showLoadingOverlay();var l={action:"charitable_get_campaign_builder_template_data",id:e,title:t.campaignTitle,nonce:charitable_builder.nonce};$.post(charitable_builder.ajax_url,l,(function(e){if(e.success){$("#charitable-field-options .charitable-layout-options-group-inner").find(".charitable-panel-field").remove(),$("#charitable-field-options .charitable-select-field-notice").show(),t.quilled=[],n.$nextFieldId.val(0),d.hideLoadingOverlay();var i=void 0!==e.data.preview&&e.data.preview,l=void 0!==e.data.field_options&&e.data.field_options,r=void 0!==e.data.tab_options&&e.data.tab_options,o=void 0!==e.data.advanced&&e.data.advanced;i?d.addLayoutToPreview(i):wpchar.debug("previewLayout is false or not defined"),l?d.addFieldOptions(l):wpchar.debug("previewFieldOptions is false or not defined"),r?d.addTabOptions(r):wpchar.debug("previewTabOptions is false or not defined"),o?d.addAdvancedOptions(o):wpchar.debug("previewAdvancedOptions is false or not defined"),Charitable.Admin.Builder.DragFields.ready(),d.updateFormHiddenFields(),d.updateFormHiddenFieldID(),$(".campaign-builder-htmleditor").each((function(){d.initHTMLEditorFields($(this))})),$(".campaign-builder-htmleditor-min").each((function(){d.initHTMLEditorFields($(this),!0)})),t.didInitHTMLEditorFields=!0,n.$preview.find(".charitable-field-section").each((function(){d.checkFieldTargetState($(this))})),d.checkAllRecommendedFields(),d.updateGoalRelatedItems(),d.updateEndDateRelatedItems(),a&&d.panelSwitch("design"),$(".charitable-campaign-suggested-donations-mini").each((function(){d.initSuggestedDonationsMini($(this)),d.updateSuggestdDonationsMiniRowsFromSettings($(this))})),d.checkFieldAllow(),d.checkFieldMax(),void 0!==e.data.settings.general.description&&""!=e.data.settings.general.description&&(t.campaignDescription=e.data.settings.general.description,n.$settingsPanel.find('input[name="settings[general][description]"').val(t.campaignDescription)),d.setCampaignNotSaved()}else d.formSaveError(e.data)})).fail((function(e,a,t){d.formSaveError()})).always((function(){}))},checkNoFieldsPreview(e=!1){!1===e&&0===n.$preview.find('.charitable-field-section[data-section-type="fields"] .charitable-field').length&&void 0!==charitable_builder.no_field_preview?($("#charitable-design-wrap").addClass("no-fields-mode"),i.find(".charitable-no-fields-area").hasClass("charitable-hidden")&&i.find(".charitable-no-fields-area").removeClass("charitable-hidden")):(i.find(".charitable-no-fields-area").hasClass("charitable-hidden")||i.find(".charitable-no-fields-area").addClass("charitable-hidden"),$("#charitable-design-wrap").removeClass("no-fields-mode"))},checkFieldTargetState(e=!1){!1!==e&&("fields"!==e.data("section-type")&&"tabs"!==e.data("section-type")||("fields"===e.data("section-type")?0===e.find(".charitable-field").length?e.removeClass("charitable-field-target-inactive").addClass("charitable-field-target"):e.removeClass("charitable-field-target").addClass("charitable-field-target-inactive"):"tabs"===e.data("section-type")&&(0===e.find(".tab_content_item.active .charitable-field").length?e.find(".tab_content_item.active").removeClass("empty-tab").addClass("empty-tab"):e.find(".tab_content_item.active").removeClass("empty-tab"))))},addAdvancedOptions(e){$(".charitable-layout-options-tab-advanced").find("input, select").each((function(){var a=$(this),t=a.data("advanced-field-id");void 0!==e[t]&&""!=t&&(a.is("select")?a.val(e[t]).change():a.val(e[t]))}))},addFieldOptions(e){n.$fieldOptions.find(".charitable-layout-options-group-inner .charitable-select-field-notice").after(e)},addTabOptions(e){
n.$fieldOptions.find(".charitable-layout-options-tab.charitable-layout-options-tab-tabs .charitable-layout-options-group-inner").html(e)},addLayoutToPreview(e){n.$preview.find(".charitable-design-wrap").replaceWith(e)},alignFieldEvents:function(e){e.on("click",".charitable-panel-field-align a",(function(e){e.preventDefault();var a=$(this),t=a.closest(".charitable-panel-field"),i=""!==a.data("align-value")?a.data("align-value"):"center";t.find("span").removeClass("active"),t.find('input[type="hidden"').val(i),a.parent().addClass("active"),d.setCampaignNotSaved()}))},numberSliderEvents:function(e){n.$fieldOptions.on("input change",'input[type="range"]',(function(e){var a=$(this).attr("min-actual")?parseInt($(this).attr("min-actual")):0,t=$(this).val();a>0&&(t<=a?($(this).val(a),$(this).next().addClass("min-reach")):$(this).next().removeClass("min-reach")),d.setCampaignNotSaved()})),e.on("change input",".charitable-panel-field-number-slider input[type=range]",(function(e){var a=$(e.target).siblings(".charitable-number-slider-hint");a.attr("data-hint",e.target.value),a.html(e.target.value+a.data("symbol")+"<small>minimum</small>")})),e.on("input",".charitable-field-option-row-min_max .charitable-input-row .charitable-number-slider-min",d.fieldNumberSliderUpdateMin),e.on("input",".charitable-field-option-row-min_max .charitable-input-row .charitable-number-slider-max",d.fieldNumberSliderUpdateMax),e.on("input",".charitable-number-slider-default-value",_.debounce(d.changeNumberSliderDefaultValue,500)),e.on("input",".charitable-number-slider-step",_.debounce(d.changeNumberSliderStep,500)),e.on("focusout",".charitable-number-slider-step",d.checkNumberSliderStep),e.on("input",".charitable-number-slider-value-display",_.debounce(d.changeNumberSliderValueDisplay,500)),e.on("input",".charitable-number-slider-min",_.debounce(d.changeNumberSliderMin,500)),e.on("input",".charitable-number-slider-max",_.debounce(d.changeNumberSliderMax,500))},changeNumberSliderMin:function(e){var a=$(e.target).parents(".charitable-field-option-row").data("fieldId"),t=parseFloat(e.target.value);isNaN(t)||d.updateNumberSliderDefaultValueAttr(a,e.target.value,"min")},changeNumberSliderMax:function(e){var a=$(e.target).parents(".charitable-field-option-row").data("fieldId"),t=parseFloat(e.target.value);isNaN(t)||d.updateNumberSliderDefaultValueAttr(a,e.target.value,"max").updateNumberSliderStepValueMaxAttr(a,e.target.value)},changeNumberSliderValueDisplay:function(a){var t=a.target.value,i=$(a.target).parents(".charitable-field-option-row").data("fieldId"),l=e.getElementById("charitable-field-option-"+i+"-default_value");l&&d.updateNumberSliderHintStr(i,t).updateNumberSliderHint(i,l.value)},changeNumberSliderStep:function(e){var a=parseFloat(e.target.value);if(!isNaN(a)){var t=parseFloat(e.target.max),i=parseFloat(e.target.min),l=$(e.target).parents(".charitable-field-option-row").data("fieldId");a<=0||(a>t?e.target.value=t:a<i?e.target.value=i:d.updateNumberSliderAttr(l,a,"step").updateNumberSliderDefaultValueAttr(l,a,"step"))}},checkNumberSliderStep:function(e){var a=parseFloat(e.target.value),t=$(this);!isNaN(a)&&a>0||$.confirm({title:charitable_builder.heads_up,content:charitable_builder.error_number_slider_increment,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){t.val("").trigger("focus")}}}})},changeNumberSliderDefaultValue:function(e){var a=parseFloat(e.target.value);if(!isNaN(a)){var t=parseFloat(e.target.max),i=parseFloat(e.target.min),l=$(e.target).parents(".charitable-field-option-row-default_value").data("fieldId");if(a>t)return void(e.target.value=t);if(a<i)return void(e.target.value=i);d.updateNumberSlider(l,a).updateNumberSliderHint(l,a)}},updateNumberSliderDefaultValueAttr:function(a,t,i){var l=e.getElementById("charitable-field-option-"+a+"-default_value");if(l){var n=parseFloat(l.value);l.setAttribute(i,t),t=parseFloat(t),"max"===i&&n>t&&(l.value=t,$(l).trigger("input")),"min"===i&&n<t&&(l.value=t,$(l).trigger("input"))}return this},updateNumberSlider:function(a,t){var i=e.getElementById("charitable-number-slider-"+a);return i&&(i.value=t),this},updateNumberSliderAttr:function(a,t,i){var l=e.getElementById("charitable-number-slider-"+a);return l&&l.setAttribute(i,t),this},updateNumberSliderHintStr:function(a,t){var i=e.getElementById("charitable-number-slider-hint-"+a);return i&&(i.dataset.hint=t),this},updateNumberSliderHint:function(a,t){var i=e.getElementById("charitable-number-slider-hint-"+a);return i&&(i.innerHTML=wpchar.sanitizeHTML(i.dataset.hint).replace("{value}","<b>"+t+"</b>")),this},fieldNumberSliderUpdateMin:function(e){var a=$(e.target).parents(".charitable-field-option-row-min_max"),t=parseFloat(a.find(".charitable-number-slider-max").val()),l=parseFloat(e.target.value);if(!isNaN(l)){if(t<=l)return e.preventDefault(),void(this.value=t);var n=a.data("field-id");i.find("#charitable-field-"+n+' input[type="range"]').attr("min",l)}},fieldNumberSliderUpdateMax:function(e){var a=$(e.target).parents(".charitable-field-option-row-min_max"),t=parseFloat(a.find(".charitable-number-slider-min").val()),l=parseFloat(e.target.value);if(!isNaN(l)){if(t>=l)return e.preventDefault(),void(this.value=t);var n=a.data("field-id");i.find("#charitable-field-"+n+' input[type="range"]').attr("max",l)}},updateNumberSliderStepValueMaxAttr:function(a,t){var i=e.getElementById("charitable-field-option-"+a+"-step");if(i){var l=parseFloat(i.value);i.setAttribute("max",t),l>(t=parseFloat(t))&&(i.value=t,$(i).trigger("input"))}return this},isVisitedViaBackButton:function(){if(!performance)return!1;var e=!1;return performance.getEntriesByType("navigation").forEach((function(a){"back_forward"===a.type&&(e=!0)})),e},hideLoadingOverlay:function(){var e=$("#charitable-builder-overlay");e.addClass("fade-out"),setTimeout((function(){e.hide()}),200)},showLoadingOverlay:function(){var e=$("#charitable-builder-overlay");e.removeClass("fade-out"),e.show()},updateFormUI:function(e=!1,a=!1){var i=!1;i=(i="title"===e?a:$("input.charitable-form-name").val()).replace(/[^a-z0-9 _.,!"'/$]/gi,""),n.$campaignNameTopBanner=$("input.charitable-form-name"),n.$campaignNamePreview=$(".charitable-preview .charitable-form-name"),n.$campaignNameFieldTitleSettings=$("input.charitable-campaign-builder-title"),n.$campaignNameTopBanner.val(i),n.$campaignNamePreview.html(i),n.$campaignNameFieldTitleSettings.val(i),n.$preview.find(".charitable-field-campaign-title .charitable-campaign-builder-placeholder-preview-text").html('<h1 class="charitable-campaign-title">'+i+"</h1>"),"title"===e&&(t.campaignTitle=i,d.resizeTopCampaignTitleInputBox())},bindUIActions:function(){d.bindAutoResizeCampaignTitle(),d.bindUIEditCampaignTitle(),d.bindCampaignTitleBlockTextField(),d.bindUIActionsPanels(),d.bindUIActionsFields(),d.bindUIActionsPreview(),d.bindUIActionsSaveExit(),d.bindUIActionsGeneral(),d.bindUITabs(),i.on("change","input, textarea, select, checkbox, radio",(function(e){d.setCampaignNotSaved()})),d.bindUILayoutOptionsAdvanced(),d.bindUISettingsRevealGroups(),d.bindUIMoneyTextFields(),d.checkFieldConditionals(),i.on("change","select#charitable-panel-field-settings-campaign_campaign_creator_id",(function(e){d.updateCampaignCreatorInfo()})),i.on("click","div#charitable-marketing-form a.button-link, div#charitable-payment-form a.button-link, div#charitable-feedback-form a.button-link",(function(e){e.preventDefault(),d.initFeedbackForms($(this))})),i.on("keyup","table.charitable-campaign-suggested-donations-mini input",(function(e){var a=parseInt($(this).closest(".charitable-panel-field").data("field-id"));if(a>0){var t=$(this).index('.charitable-panel-field[data-field-id="'+a+'"] table.charitable-campaign-suggested-donations-mini input[type="text"].campaign_suggested_donations');d.updateSuggestDonationsSettings($(this),t)}})),i.on("change keyup blur input",'table.charitable-campaign-suggested-donations input[type="text"].campaign_suggested_donations',(function(e){var a=$(this).index('.charitable-campaign-suggested-donations input[type="text"].campaign_suggested_donations');$(this).attr("name").indexOf("recurring")<1&&d.updateSuggestDonationsSettings($(this),a)})),i.on("change",'.charitable-campaign-builder-allow-custom-donations input[type="checkbox"]',(function(e){$('.charitable-campaign-builder-allow-custom-donations input[type="checkbox"]').prop("checked",$(this).is(":checked")),d.updateAllowCustomDonationSettings($(this).is(":checked"))})),i.on("change",'input[type="radio"].campaign_suggested_donations',(function(e){parseInt($(this).closest(".charitable-panel-field").data("field-id")),$(this).attr("name");d.updateSuggestedDonationAmountDefault($(this).val())})),d.bindUIInputRange(),i.on("click",".education-buttons button.update-to-pro-link",(function(e){$(this).prev("a").length>0?a.open($(this).prev("a").attr("href"),"_blank"):a.open("https://wpcharitable.com/lite-vs-pro/","_blank")}))},bindUILayoutOptionsAdvanced:function(){i.on("change","select#charitable-design-layout-options-advanced-tab-style",(function(e){e.preventDefault();var a=$(this),t=$("nav.charitable-campaign-preview-nav");$(a).find("option").each((function(){t.removeClass("tab-style-"+this.value)})),t.addClass("tab-style-"+a.find(":selected").val())})),i.on("change","select#charitable-design-layout-options-advanced-tab-size",(function(e){e.preventDefault();var a=$(this),t=$("nav.charitable-campaign-preview-nav");$(a).find("option").each((function(){t.removeClass("tab-size-"+this.value)})),t.addClass("tab-size-"+a.find(":selected").val())}))},tabGroupsAdd:function(e,a){if(a.preventDefault(),n.$sortableTabContent.find(".tab_content_item").length>=t.maxNumberOfTabs)d.formGenericNotice("You cannot have more than "+t.maxNumberOfTabs+" tabs in your campaign template.");else{var l=$(e),r=l.parent().find(".charitable-group.charitable-layout-options-tab-group.hidden").last().clone(),o=n.$preview.find(".tab-content"),c="html",s=$(".charitable-group.charitable-layout-options-tab-group").map((function(){return parseInt($(this).attr("data-group_id"))})).get(),p=Math.max.apply(null,s)+1;void 0!==p?(r.attr("data-group_id",p),r.attr("data-tab-id",p),r.find(".charitable-group-row").attr("data-tab-id",p),r.find("input, select, textarea, label").each((function(e){var a=$(this),t=a.attr("for"),i=a.attr("name"),l=a.attr("id");void 0!==l&&!1!==l&&a.attr("id",a.attr("id").replace("_xxx_","_"+p+"_")),void 0!==i&&!1!==i&&a.attr("name",a.attr("name").replace("_xxx_","_"+p+"_")),void 0!==t&&!1!==t&&a.attr("for",a.attr("for").replace("_xxx_","_"+p+"_"))})),r.find('input[name="tabs__'+p+'__title"]').val("New Tab"),r.find('textarea[name="tabs__'+p+'__desc"]').html("Content"),$(".charitable-layout-options-tab-group").removeClass("active"),r.addClass("active"),r.removeClass("charitable-closed").addClass("charitable-open").removeClass("hidden").find(".charitable-angle-right").removeClass("charitable-angle-right").addClass("charitable-angle-down"),l.before(r),d.bindUIActionPanelsTabs(),d.checkHideTabNavigation(),$("nav.charitable-campaign-preview-nav ul li").removeClass("active"),o.find("ul li").removeClass("active"),$("nav.charitable-campaign-preview-nav ul").append('<li data-tab-type="html" data-tab-id="'+p+'" class="tab_title active" id="tab_'+p+'_title"><a href="#">'+charitable_builder.new_tab+"</a></li>"),o.find("ul").append('<li id="tab_'+p+'_content" class="tab_content_item empty-tab active tab_type_'+c+'" data-tab-type="'+c+'" data-tab-id="'+p+'"><div class="charitable-tab-wrap ui-sortable"><p class="empty-tab-notice">'+charitable_builder.empty_tab+"</p></div></li>"),o.removeClass("empty-tabs"),o.find(".no-tab-notice").remove(),i.trigger("charitableAddNewTab",p)):d.formGenericError("Error ecountered attempting to add another tab.")}},bindUITabs:function(){i.on("click","button.charitable-tab-groups-add",(function(e){d.tabGroupsAdd(this,e)})),i.find(".charitable-layout-options-tab-tabs .charitable-layout-options-group-inner").sortable({handle:".charitable-draggable",update:function(e,a){var t=$(".charitable-group.charitable-layout-options-tab-group").map((function(){if(!$(this).hasClass("hidden"))return parseInt($(this).attr("data-group_id"))})).get(),i=$(".charitable-group.charitable-layout-options-tab-group").map((function(){if($(this).hasClass("active"))return parseInt($(this).attr("data-group_id"))})).get();$("nav.charitable-campaign-preview-nav ul").empty(),t.forEach((function(e){var a=$("#charitable-field-options").find('[data-group_id="'+e+'"]'),t=e,l=i.indexOf(e)>=0?"active":"",n=0!==e&&""!==a.find('input[name="tabs__'+t+'__type"').val()?a.find('input[name="tabs__'+t+'__type"').val():"html",r=a.find('input[name="tabs__'+t+'__title"').val();$("nav.charitable-campaign-preview-nav ul").append('<li data-tab-type="'+n+'" data-tab-id="'+e+'" class="tab_title '+l+'" id="tab_'+e+'_title"><a href="#">'+r+"</a></li>")}))}}),i.on("click","input, select, textarea, .ql-editor",".charitable-layout-options-tab-tabs .charitable-layout-options-group-inner .charitable-layout-options-tab-group",(function(e){if(!$(this).closest(".charitable-layout-options-tab-group").hasClass("active")){var a=$(this).closest(".charitable-layout-options-tab-group").data("group_id");$('.charitable-preview nav.charitable-campaign-preview-nav li[data-tab-id="'+a+'"] a').click()}})),i.on("click","a.charitable-configure-tab-settings",(function(e){d.fieldTabToggle("layout-options"),$(".charitable-layout-options-tab").removeClass("active"),$(".charitable-layout-options-tab.charitable-layout-options-tab-tabs").addClass("active")})),i.on("click","nav li.tab_title a",(function(e){e.preventDefault();var a=$(".charitable-campaign-preview"),t=$(this).parent().data("tab-id");a.find("li#tab_"+t+"_title").attr("data-tab-type");$(".tab-content ul li").removeClass("active"),$("nav li.tab_title").removeClass("active"),$(this).parent().addClass("active"),$(".tab-content ul li#tab_"+t+"_content").addClass("active"),$(".charitable-layout-options-tab").removeClass("active"),$(".charitable-layout-options-tab.charitable-layout-options-tab-tabs").addClass("active"),$(".charitable-layout-options-tab").find(".charitable-layout-options-tab-group").each((function(){$(this).removeClass("charitable-open"),"true"===wpCookies.get("charitable_panel_layout_options_tabs_tab_open_"+$(this).data("group_id"))?($(this).addClass("charitable-open"),$(this).find(".charitable-general-layout-heading a.charitable-toggleable-group i").addClass("charitable-angle-down"),$(this).find(".charitable-general-layout-heading a.charitable-toggleable-group i").removeClass("charitable-angle-right"),$(this).removeClass("charitable-closed")):($(this).removeClass("charitable-open"),$(this).find(".charitable-general-layout-heading a.charitable-toggleable-group i").removeClass("charitable-angle-down"),$(this).find(".charitable-general-layout-heading a.charitable-toggleable-group i").addClass("charitable-angle-right"),$(this).addClass("charitable-closed"))})),$(".charitable-layout-options-tab .charitable-group").removeClass("active"),$(".charitable-layout-options-tab").find("[data-group_id="+t+"]").addClass("active").removeClass("charitable-closed"),$(".charitable-layout-options-tab").find("[data-group_id="+t+"]").find(".charitable-group-rows").show(),$(".charitable-layout-options-tab").find("[data-group_id="+t+"]").find(".charitable-toggleable-group i").removeClass(".charitable-angle-right").addClass("charitable-angle-down"),$("#layout-options a").click(),$("#charitable-preview-tab-container").addClass("active"),wpCookies.set("charitable_panel_tab_section_tab_id",t,2592e3),wpCookies.set("charitable_panel_layout_options_tabs_tab_open_"+t,!0,2592e3),wpCookies.set("charitable_panel_content_section","",2592e3),wpCookies.set("charitable_panel_active_field_id","",2592e3)})),i.on("change",".charitable-group select.tab_type",(function(e){e.preventDefault();var a=$(this),t=a.closest(".charitable-group").data("group_id"),i=$(".charitable-campaign-preview"),l=a.val();i.find("nav li.tab_title[data-tab-id="+t+"]").attr("data-tab-type",l),i.find("div.tab-content ul li#tab_"+t+"_content").attr("data-tab-type",l),i.find("div.tab-content ul li#tab_"+t+"_content").removeClass((function(e,a){return(a.match(/(^|\s)tab_type_\S+/g)||[]).join(" ")})),i.find("div.tab-content ul li#tab_"+t+"_content").addClass("tab_type_"+l);var n={action:"charitable_tab_content_preview",type:l,group_id:t,nonce:charitable_builder.nonce};return $.post(charitable_builder.ajax_url,n,(function(e){e.success?i.find("div.tab-content ul li#tab_"+t+"_content").html(e.data.output):d.formSaveError(e.data)})).fail((function(e,a,t){d.formSaveError()})).always((function(){}))})),i.on("input","input#charitable-panel-field-settings-charitable-campaign-enable-tabs",(function(e){$(this).is(":checked")?($("#charitable-preview-tab-container").addClass("disabled"),$("#charitable-design-layout-options-advanced-tab-style").prop("disabled",!0).addClass("disabled"),$("#charitable-design-layout-options-advanced-tab-size").prop("disabled",!0).addClass("disabled")):($("#charitable-preview-tab-container").removeClass("disabled"),$("#charitable-design-layout-options-advanced-tab-style").prop("disabled",!1).removeClass("disabled"),$("#charitable-design-layout-options-advanced-tab-size").prop("disabled",!1).removeClass("disabled"))})),i.on("input","input.charitable-settings-tab-visible-nav",(function(e){const a=$(this).is(":checked"),t=$(this).closest(".charitable-tab-title-row").data("tab-id");a?n.$preview.find("nav li#tab_"+t+"_title").addClass("charitable-tab-hide"):n.$preview.find("nav li#tab_"+t+"_title").removeClass("charitable-tab-hide")})),i.on("keydown",'.charitable-tab-title-row input[type="text"]',(function(e){var a=e.keyCode||e.which;(!(a>=65&&a<=90||a>=96&&a<=105||a>=35&&a<=40||32==a||e.ctrlKey&&65==a||e.ctrlKey&&67==a||e.ctrlKey&&88==a||e.ctrlKey&&86==a||e.metaKey&&65==a||e.metaKey&&67==a||e.metaKey&&88==a||e.metaKey&&86==a||a>=96&&a<=105||110==a||190==a||a>=37&&a<=40||46==a||173==a||8==a||a>=48&&a<=57)||e.ctrlKey&&e.altKey)&&e.preventDefault()})),i.on("change",'.charitable-tab-title-row input[type="text"]',(function(e){""===$(this).val().trim()&&$(this).val("New Tab")}))},bindUIInputRange:function(){i.on("mouseenter",'input[type="range"].charitable-indicator-on-hover, .charitable-panel-field-align a',(function(e){var a=parseInt($(this).closest(".charitable-panel-field").data("field-id"));a>0&&n.$preview.find("#charitable-field-"+a+" .charitable-preview-field-indicator").removeClass("charitable-hidden")})),i.on("mouseleave",'input[type="range"].charitable-indicator-on-hover, .charitable-panel-field-align a',(function(e){var a=parseInt($(this).closest(".charitable-panel-field").data("field-id"));a>0&&n.$preview.find("#charitable-field-"+a+" .charitable-preview-field-indicator").addClass("charitable-hidden")}))},bindAutoResizeCampaignTitle:function(){i.on("input","input#charitable_settings_title",(function(e){var a=$(this),t=a.val(),i=t.length,l=10.8*i+10;wpchar.debug(t),wpchar.debug(i),wpchar.debug($("#charitable_settings_title").val()),a.css("width",l+"px"),d.setCampaignNotSaved(),d.updateFormUI("title",t),d.resizeTopCampaignTitleInputBox()}))},resizeTopCampaignTitleInputBox:function(){var e=$("input#charitable_settings_title"),a=10.8*e.val().length+10;e.css("width",a+"px")},bindCampaignTitleBlockTextField:function(){i.on("keyup","input.charitable-campaign-builder-title",(function(e){d.updateFormUI("title",$(this).val())}))},bindUIEditCampaignTitle:function(){i.on("click",".charitable-edit-campaign-title-area",(function(e){e.preventDefault(),d.allowTitleUpdate($(this))})),i.on("focusout","input#charitable_settings_title",(function(e){$(".charitable-edit-campaign-title-area").removeClass("edit"),""===$("#charitable_settings_title").val().trim()&&$("#charitable_settings_title").val(charitable_builder.default_campaign_title),$("#charitable_settings_title").attr("disabled",!0),d.updateFormUI("title",$("#charitable_settings_title").val());var a=$("input#charitable_settings_title"),t=11*a.val().length+10;a.css("width",t+"px")})),$(e).on("mouseup",i,(function(e){0===$(e.target).closest(".charitable-edit-campaign-title-area").length&&($(".charitable-edit-campaign-title-area").removeClass("edit"),""===$("#charitable_settings_title").val().trim()&&$("#charitable_settings_title").val(charitable_builder.default_campaign_title),$("#charitable_settings_title").attr("disabled",!0)),d.updateFormUI("title",$("#charitable_settings_title").val())}))},allowTitleUpdate:function(e){e.hasClass("edit")?($("#charitable_settings_title").attr("disabled",!0),e.removeClass("edit")):($("#charitable_settings_title").removeAttr("disabled"),e.addClass("edit"),$("#charitable_settings_title").focus().select())},bindUIActionsPanels:function(){i.on("click","#charitable-panels-toggle button:not(.charitable-panel-help-button), .charitable-panel-switch",(function(e){e.preventDefault(),$(this).hasClass("disabled")||d.panelSwitch($(this).data("panel"))})),i.on("click",".charitable-panel .charitable-panel-sidebar-section:not(.charitable-need-upgrade):not(.charitable-not-available):not(.charitable-not-installed):not(.charitable-not-activated):not(.charitable-installed-refresh):not(.charitable-not-available):not(.charitable-addon-file-missing)",(function(e){d.panelSectionSwitch(this,e)})),i.on("click",".charitable-panels .charitable-panel-sidebar-content .charitable-panel-sidebar-toggle",(function(){$(this).parent().toggleClass("charitable-panel-sidebar-closed")})),i.on("focusout",'input[name="tabs__campaign__title"]',(function(e){e.preventDefault(),d.updateFormUI("tabs__campaign__title",$(this).val())})),d.bindUIActionPanelsTabs()},bindUIActionPanelsTabs:function(){i.on("input",'.charitable-tab-title-row input[type="text"]',(function(e){e.preventDefault();var a=$(this),t=a.closest(".charitable-group"),i=t.attr("data-group_id"),l=0===a.val().length?"New Tab":a.val(),n=d.removeTags(l);t.find(".charitable-general-layout-heading").find("span").html(n),$("nav.charitable-campaign-preview-nav ul").find("#tab_"+i+"_title a").html(n)}))},checkHideTabNavigation:function(){$("#charitable-field-options .charitable-layout-options-tab-group").length-1>1?$("#charitable-field-options").find("input.charitable-settings-tab-visible-nav").each((function(){$(this).prop("checked",!1).attr("disabled",!0),$(this).parent().find("label").addClass("charitable-disabled"),n.$preview.find("nav.charitable-campaign-preview-nav li").removeClass("charitable-tab-hide")})):$("#charitable-field-options").find("input.charitable-settings-tab-visible-nav").each((function(){$(this).removeAttr("disabled"),$(this).parent().find("label").removeClass("charitable-disabled")}))},removeTags:function(e){return e},panelSwitch:function(e){var a=$("#charitable-panel-"+e),t=$(".charitable-panel-"+e+"-button");if((d.hasTemplate()||"template"===e)&&!a.hasClass("active")){if(CharitableUtils.triggerEvent(i,"charitablePanelSwitch",[e]).isDefaultPrevented()||!charitable_panel_switch)return!1;$("#charitable-panels-toggle").find("button").removeClass("active"),$(".charitable-panel").removeClass("active"),t.addClass("active"),a.addClass("active"),history.replaceState({},null,wpchar.updateQueryString("view",e)),i.trigger("charitablePanelSwitched",[e]),wpCookies.set("charitable_panel",e,2592e3),wpCookies.set("charitable_panel_content_section","",2592e3)}},panelSectionSwitch:function(e,a){a&&a.preventDefault();var t=$(e),i=t.parent().parent(),l=t.data("section"),n=i.find(".charitable-panel-sidebar-section"),r=i.find(".charitable-panel-sidebar-section-"+l);t.hasClass("upgrade-modal")||t.hasClass("education-modal")||r.hasClass("active")||d.panelSectionSwitchTo(l,i,n,r)},panelSectionSwitchTo:function(e,a,t,l){if(CharitableUtils.triggerEvent(i,"charitablePanelSectionSwitch",e).isDefaultPrevented()||!charitable_panel_switch)return!1;t.removeClass("active"),l.addClass("active"),a.find(".charitable-panel-content-section").hide(),a.find(".charitable-panel-content-section-"+e).show();wpCookies.set("charitable_panel_content_section",e,2592e3)},bindUIActionsFields:function(){i.on("click",".charitable-tab a",(function(e){e.preventDefault(),d.fieldTabToggle($(this).parent().attr("id")),"add-layout"===$(this).parent().attr("id")&&d.resetPreviewArea()})),i.on("click",".charitable-layout-options-tab-tabs .charitable-toggleable-group",(function(e){e.preventDefault(),d.fieldGroupTogglev2($(this),"click")})),i.on("click",".charitable-add-fields .charitable-toggleable-group",(function(e){e.preventDefault(),d.fieldGroupTogglev3($(this),"click")})),i.on("click",".charitable-tab-group-delete",(function(e){if(e.preventDefault(),e.stopPropagation(),!d.isFormPreviewActionsDisabled(this)){var a=$(this).closest(".charitable-group").attr("data-group_id");d.tabDelete(a)}})),i.on("click",".charitable-field",(function(e){e.target.classList.contains("charitable-dismiss-button")||(e.stopPropagation(),$(this).find(".charitable-field-edit").click())})),i.on("click",".charitable-field-delete",(function(e){e.preventDefault(),e.stopPropagation();var a=!$(this).parent().hasClass("charitable-missing-addon-content"),t=parseInt($(this).closest(".charitable-field").data("field-id"));d.fieldDelete(t,a)})),i.on("click",".charitable-field-duplicate",(function(e){e.preventDefault(),e.stopPropagation(),d.fieldDuplicate($(this).parent().data("field-id"))})),i.on("click",".charitable-field-edit",(function(e){e.preventDefault(),e.stopPropagation(),d.resetPreviewArea(),$(this).parent().addClass("active"),$("ul.charitable-tabs li#add-layout a").removeClass("active"),$("ul.charitable-tabs li#layout-options a").addClass("active");var a=parseInt($(this).parent().data("field-id"));wpCookies.set("charitable_panel_active_field_id",a,2592e3),d.fieldEdit($(this).data("type"),$(this).data("section"),$(this).parent().data("field-id"),a,$(this).parent().data("field-type"))})),i.on("click",".charitable-add-fields-button",(function(e){e.preventDefault();const a=$(this);if(a.hasClass("ui-draggable-disabled"))return;let t=a.data("field-type");CharitableUtils.triggerEvent(i,"charitableBeforeFieldAddOnClick",[t,a]).isDefaultPrevented()||d.fieldAdd(t,{$sortable:"default"})})),i.on("charitableFieldAdd",(function(e,a,t){-1!==$.inArray(t,["campaign-title","campaign-description","campaign-overview","progress-bar","donation-options","social-sharing","social-links","photo","organizer","html","donate-button","donate-amount","campaign-summary","donate-form","donor-wall","shortcode","text","video"])&&d.fieldChoiceSortable(t,`#charitable-field-option-row-${a}-choices ul`)})),i.on("click",".charitable-group-toggle",(function(e){if(CharitableUtils.triggerEvent(i,"charitableFieldOptionGroupToggle").isDefaultPrevented())return!1;e.preventDefault(),d.resetPreviewArea();var a=$(this).closest(".charitable-layout-options-tab");a.siblings(".charitable-layout-options-tab").removeClass("active"),a.addClass("active"),$(this).parent().hasClass("charitable-layout-options-tab-tabs")?$("#charitable-preview-tab-container").toggleClass("active"):$("#charitable-preview-tab-container").removeClass("active"),$(this).parent().hasClass("charitable-layout-options-tab-general")?wpCookies.set("charitable_panel_design_layout_options_group","general",2592e3):$(this).parent().hasClass("charitable-layout-options-tab-tabs")?wpCookies.set("charitable_panel_design_layout_options_group","tabs",2592e3):$(this).parent().hasClass("charitable-layout-options-tab-advanced")&&wpCookies.set("charitable_panel_design_layout_options_group","advanced",2592e3),wpCookies.set("charitable_panel_active_field_id","",2592e3),$(".charitable-layout-options-tab-general .charitable-layout-options-group-inner").html(),$(".charitable-campaign-preview .charitable-select-field").removeClass("active")})),i.on("click",".charitable-field-edit",(function(e){e.preventDefault(),$("#layout-options a").addClass("active"),$(".charitable-add-fields").hide(),$(".charitable-field-options").show();var a=$(".charitable-layout-options-tab-general");a.siblings(".charitable-layout-options-tab").removeClass("active"),a.addClass("active")})),i.on("click",(function(){d.focusOutEvent()})),d.photoFieldEvents(i),d.campaignSummaryEvents(i),d.socialSharingEvents(i),d.socialLinkingEvents(i),d.donateButtonEvents(i),d.donateWallEvents(i),d.progressBarEvents(i),d.shortcodeEvents(i),d.organizerEvents(i),d.cssTextFieldEvents(i),d.textFieldEvents(i),d.headlineEvents(i),d.numberSliderEvents(i),d.alignFieldEvents(i),d.highlightEvents(i),d.advancedLayoutOptionsEvents(i),d.previewHover(i),d.goalEvents(i),d.endDateEvents(i)},endDateEvents:function(e){e.on("change","#charitable-panel-field-settings-campaign_end_date",(function(e){d.updateEndDateRelatedItems($(this).val())}))},updateEndDateRelatedItems:function(e="",a=$("#charitable-panel-field-settings-campaign_end_date")){""===e&&a.length&&(e=a.val()),""===e.trim()?(wpchar.debug("made it - no end date"),n.$preview.find(".charitable-field-campaign-summary").each((function(){var e=$(this).attr("data-field-id");$(this).find(".campaign-time-left.campaign-summary-item").addClass("charitable-hidden"),wpchar.debug($('input[name="_fields['+e+"][show_hide][campaign_hide_time_remaining]")),n.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_time_remaining]").attr("disabled",!0).addClass("charitable-disabled").prop("checked",!1).next().addClass("charitable-disabled")}))):(wpchar.debug("made it - there is an end date"),n.$preview.find(".charitable-field-campaign-summary").each((function(){var e=$(this).attr("data-field-id");$(this).find(".campaign-time-left.campaign-summary-item").addClass("charitable-hidden"),n.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_time_remaining]").attr("disabled",!1).removeClass("charitable-disabled").prop("checked",!1).next().removeClass("charitable-disabled")})))},goalEvents:function(e){e.on("change","#charitable-panel-field-settings-campaign_goal",(function(e){d.updateGoalRelatedItems($(this).val())}))},updateGoalRelatedItems:function(e="",a=$("#charitable-panel-field-settings-campaign_goal")){if(wpchar.debug(e,"goalAmount"),""===e&&a.length&&(e=a.val()),""===e||"0"===e||"0.00"===e)wpchar.debug("made it 0"),n.$preview.find(".charitable-field-progress-bar .progress").addClass("charitable-campaign-preview-not-available").addClass("charitable-hidden"),n.$preview.find(".charitable-field-campaign-summary").each((function(){var e=$(this).attr("data-field-id");$(this).find(".campaign-raised.campaign-summary-item").addClass("charitable-hidden"),wpchar.debug(n.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_percent_raised]")),n.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_percent_raised]").prop("checked",!1).attr("disabled",!0).addClass("charitable-disabled").next().addClass("charitable-disabled")})),n.$preview.find(".charitable-field-progress-bar .campaign-goal").each((function(){var e=$(this).find("span").html();$(this).html("<span>"+e+"</span>∞")}));else{/^\d+\,\d+$/.test(e)?(wpchar.debug("made it 2"),d.updateGoalisPresentRelatedUI(),n.$preview.find(".charitable-field-progress-bar .campaign-goal").each((function(){var a=$(this).find("span").html();parseFloat(e).toFixed(2);wpchar.debug(charitable_builder.currency_symbol+e),$(this).html("<span>"+a+"</span> "+charitable_builder.currency_symbol+e)}))):/^\d+\.\d+$/.test(e)?(wpchar.debug("made it 1"),d.updateGoalisPresentRelatedUI(),n.$preview.find(".charitable-field-progress-bar .campaign-goal").each((function(){var a=$(this).find("span").html(),t=parseFloat(e).toFixed(2);t=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),$(this).html("<span>"+a+"</span> "+charitable_builder.currency_symbol+t)}))):(wpchar.debug("made it 3"),d.updateGoalisPresentRelatedUI(),e=e.replace(/[^0-9\.\,]/g,""),n.$preview.find(".charitable-field-progress-bar .campaign-goal").each((function(){var a=$(this).find("span").html()
;$(this).html("<span>"+a+"</span> "+charitable_builder.currency_symbol+e)})))}},updateGoalisPresentRelatedUI:function(){n.$preview.find(".charitable-field-campaign-summary").each((function(){var e=$(this).attr("data-field-id"),a=$(this);$('input[name="_fields['+e+"][show_hide][campaign_hide_percent_raised]").is(":checked")&&($(this).hasClass("charitable-hidden")||a.find(".campaign-raised.campaign-summary-item").removeClass("charitable-hidden")),n.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_percent_raised]").attr("disabled",!1).removeClass("charitable-disabled").next().removeClass("charitable-disabled")})),n.$preview.find(".charitable-field-progress-bar .progress").removeClass("charitable-campaign-preview-not-available").removeClass("charitable-hidden")},highlightEvents:function(e){e.on("click","a.charitable-addon-installed-charitable-lite, a.charitable-addon-installed-charitable-pro",(function(e){e.preventDefault(),$(this).hasClass("charitable-addon-recurring-donations")&&(n.$settingsPanel.find(".charitable-panel-fields-group-recurring-donations").removeClass("charitable-highlight"),$("a.charitable-panel-sidebar-section-donation-options").click(),n.$settingsPanel.find(".charitable-panel-fields-group-recurring-donations").addClass("charitable-highlight"))})),e.on("webkitAnimationEnd oanimationend msAnimationEnd animationend",".charitable-panel-fields-group-recurring-donations",(function(e){n.$settingsPanel.find(".charitable-panel-fields-group-recurring-donations").removeClass("charitable-highlight")}))},advancedLayoutOptionsEvents:function(e){e.on("change","select#charitable-design-layout-options-show-field-names",(function(e){const a=$(this);"hide"===a.val()?n.$formPreview.addClass("charitable-preview-hide-field-names"):"show"===a.val()&&n.$formPreview.removeClass("charitable-preview-hide-field-names")})),e.on("change","select#charitable-design-layout-options-preview-mode",(function(e){const a=$(this);"normal"===a.val()?n.$formPreview.removeClass("charitable-preview-minimum-preview"):"minimum"===a.val()&&n.$formPreview.addClass("charitable-preview-minimum-preview")}))},previewHover:function(e){e.on("mouseover",".charitable-view-campaign-external-link",(function(e){n.$formPreview.addClass("charitable-preview-live")})),e.on("mouseleave",".charitable-view-campaign-external-link",(function(e){n.$formPreview.removeClass("charitable-preview-live")}))},donateButtonEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="text"].charitable-campaign-builder-donate-button-button-label',(function(e){const a=$(this),t=a.closest(".charitable-panel-field").data("field-id");d.updateDonateButtonPreview(t,a.attr("name"),a.val())}))},updateDonateButtonPreview:function(e=0,a="",t="Donate"){const i=$("#charitable-field-"+e);t=t.length>0?CharitableUtils.santitizeTextInput(t):"Donate",i.find(".placeholder").html(t)},donateWallEvents:function(e){e.on("input",".charitable-panel-field.charitable-campaign-builder-donor-wall input, .charitable-panel-field.charitable-campaign-builder-donor-wall select",(function(e){const a=$(this),t=a.closest(".charitable-panel-field").data("field-id");d.updateDonateWallPreview(t,a)}))},updateDonateWallPreview:function(e=0,a){var i={};return $('.charitable-panel-field.charitable-campaign-builder-donor-wall[data-field-id="'+e+'"]').each((function(){var a=$(this);a.find('input.charitable-checkbox-for-toggle[type="checkbox"]:checked').each((function(){var a=$(this).closest('.charitable-toggle-control[data-field-id="'+e+'"]').data("ajax-label");$(this).is(":checked")?i[a]=$(this).val():i[a]=0})),a.find('input[type="radio"]:checked,input[type="text"],input[type="number"],select').each((function(){var a=$(this).closest('.charitable-panel-field[data-field-id="'+e+'"]').data("ajax-label");i[a]=$(this).val()})),i.campaign_id=t.formID,i.field_type="donation-wall",i.field_id=e,i.action="charitable_builder_field_content_preview",i.nonce=charitable_builder.nonce})),d.disableFormActions(),$('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+e+'"]').addClass("charitable-loading"),$("#charitable-field-"+e+" .charitable-preview-field-container span.placeholder").addClass("charitable-loading").parent().prepend('<div class="charitable-loading-spinner preview-ajax"></div>'),$.post(charitable_builder.ajax_url,i,(function(a){if(a.success){$("#charitable-field-"+e+" .charitable-preview-field-container").replaceWith(a.data.output);var t=$('.charitable-panel-field-text[data-field-id="'+e+'"] input[type="text"].charitable-campaign-builder-headline');d.updateHeadlinePreview(e,t.attr("name"),t.val(),t),d.enableFormActions(),$('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+e+'"]').removeClass("charitable-loading"),$("#charitable-field-"+e+" .charitable-preview-field-container span.placeholder").removeClass("charitable-loading").parent().remove(".charitable-loading")}else wpchar.debug("Add field AJAX call is unsuccessful:",a)})).fail((function(a,t,i){wpchar.debug("Add field AJAX call failed:",a.responseText),$('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+e+'"]').removeClass("charitable-loading"),$("#charitable-field-"+e+" .charitable-preview-field-container span.placeholder").removeClass("charitable-loading").parent().remove(".charitable-loading")})).always((function(){}))},progressBarEvents:function(e){e.on("change",".charitable-panel-field.charitable-campaign-builder-progress-bar input, .charitable-panel-field.charitable-campaign-builder-progress-bar select",(function(e){var a=$(this),t=a.attr("data-field-id");d.progressBarEventsPreview(t,a)})),e.on("keyup",".charitable-panel-field.charitable-panel-field-text input.donate_label, .charitable-panel-field.charitable-panel-field-text input.donate_goal",(function(e){var a=$(this),t=a.attr("data-field-id");d.progressBarEventsPreviewLabels(t,a)}))},progressBarEventsPreviewLabels:function(e=0,a=""){const t=$("#charitable-field-"+e);a.hasClass("donate_label")&&t.find(".campaign-percent-raised span").html(a.val()),a.hasClass("donate_goal")&&t.find(".campaign-goal span").html(a.val())},progressBarEventsPreview:function(e=0,a=""){const t=$("#charitable-field-"+e);"show_donated"===a.val()&&t.find(".campaign-percent-raised").toggleClass("charitable-hidden"),"show_goal"===a.val()&&t.find(".campaign-goal").toggleClass("charitable-hidden")},cssTextFieldEvents:function(e){e.on("input",'.charitable-panel-field-text input[data-ajax-label="css_class"]',(function(e){const a=$(this),t=CharitableUtils.santitizeCSSInput(a.val());$(this).val(t),d.setCampaignNotSaved()}))},textFieldEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="text"][data-ajax-label!="css_class"]:not(.charitable-campaign-builder-headline, .charitable-campaign-builder-donate-button-button-label)',(function(e){const a=$(this),t=CharitableUtils.santitizeTextInput(a.val());$(this).val(t),d.setCampaignNotSaved()}))},headlineEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="text"].charitable-campaign-builder-headline',(function(e){const a=$(this),t=a.closest(".charitable-panel-field").data("field-id");d.updateHeadlinePreview(t,a.attr("name"),a.val(),a),d.setCampaignNotSaved()}))},updateHeadlinePreview:function(e=0,a="",t="",i){const l=$("#charitable-field-"+e),n=CharitableUtils.santitizeTitle(t),r=t.length>0?'<h5 class="charitable-field-preview-headline">'+n+"</h5>":"",o=l.find(".charitable-placeholder").length>0?".charitable-placeholder":".placeholder";i.val(n),l.find(o).find("h5.charitable-field-preview-headline").remove(),l.find(o).first().prepend(r)},shortcodeEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="text"].charitable-campaign-builder-shortcode',(function(e){const a=$(this),t=a.closest(".charitable-panel-field").data("field-id");d.updateShortcodePreview(t,a.attr("name"),a.val())}))},updateShortcodePreview:function(e=0,a="",t=""){const i=$("#charitable-field-"+e),l=t.length>0?'<h5 class="charitable-field-preview-shortcode">'+t+"</h5>":"";i.find(".placeholder.shortcode-preview").find("h5.charitable-field-preview-shortcode").remove(),i.find(".placeholder.shortcode-preview").first().prepend(l)},organizerEvents:function(e){e.on("change",".charitable-panel-field.campaign-builder-campaign-creator-id-mini select",(function(e){var a=$(this),t=$(this).find("option:selected").data("avatar"),i=a.closest(".charitable-panel-field").attr("data-field-id");d.organizerEventsPreview(i,a,t)}))},organizerEventsPreview:function(e=0,a="",t=""){$("select#charitable-panel-field-settings-campaign_campaign_creator_id").select2("val",a.val());const i=$("#charitable-field-"+e);i.find(".charitable-organizer-name").html(a.find("option:selected").text()),i.find(".charitable-organizer-image").attr("style","background-image: url("+t+");")},campaignSummaryEvents:function(e){e.on("click",'.charitable-campaign-summary-checkboxes input[type="checkbox"]',(function(e){const a=$(this),t=a.closest(".charitable-panel-field").data("field-id");d.updateCampaignSummaryPreview(t,a.attr("name"))}))},updateCampaignSummaryPreview:function(e=0,a=""){const t=$("#charitable-field-"+e);a.indexOf("campaign_hide_percent_raised")>=0&&t.find(".campaign_hide_percent_raised").toggleClass("charitable-hidden"),a.indexOf("campaign_hide_amount_donated")>=0&&t.find(".campaign_hide_amount_donated").toggleClass("charitable-hidden"),a.indexOf("campaign_hide_number_of_donors")>=0&&t.find(".campaign_hide_number_of_donors").toggleClass("charitable-hidden"),a.indexOf("campaign_hide_time_remaining")>=0&&t.find(".campaign_hide_time_remaining").toggleClass("charitable-hidden")},socialSharingEvents:function(e){e.on("click",'.charitable-social-network-checkboxes input[type="checkbox"]',(function(e){const a=$(this),t=a.closest(".charitable-panel-field").data("field-id");d.updateSocialSharingPreview(t,a.attr("name"))}))},updateSocialSharingPreview:function(e=0,a=""){const t=$("#charitable-field-"+e);a.indexOf("twitter")>=0&&t.find(".charitable-social-sharing-preview-twitter").toggleClass("charitable-hidden"),a.indexOf("facebook")>=0&&t.find(".charitable-social-sharing-preview-facebook").toggleClass("charitable-hidden"),a.indexOf("linkedin")>=0&&t.find(".charitable-social-sharing-preview-linkedin").toggleClass("charitable-hidden"),a.indexOf("instagram")>=0&&t.find(".charitable-social-sharing-preview-instagram").toggleClass("charitable-hidden"),a.indexOf("tiktok")>=0&&t.find(".charitable-social-sharing-preview-tiktok").toggleClass("charitable-hidden"),a.indexOf("pinterest")>=0&&t.find(".charitable-social-sharing-preview-pinterest").toggleClass("charitable-hidden"),a.indexOf("mastodon")>=0&&t.find(".charitable-social-sharing-preview-mastodon").toggleClass("charitable-hidden")},socialLinkingEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="url"].charitable-campaign-builder-social-links-text-field',(function(e){var a=$(this),t=a.attr("data-field-id");d.updateSocialLinksPreview(t,a.attr("name"),a.val())}))},updateSocialLinksPreview:function(e=0,a="",t=""){const i=$("#charitable-field-"+e);var l=0;$.each(["twitter","facebook","linkedin","instagram","tiktok","pinterest","mastodon"],(function(e,n){a.indexOf(n)>=0&&d.isValidURL(t)?i.find(".charitable-social-linking-preview-"+n).removeClass("charitable-hidden"):a.indexOf(n)>=0&&i.find(".charitable-social-linking-preview-"+n).addClass("charitable-hidden"),i.find(".charitable-social-linking-preview-"+n).hasClass("charitable-hidden")||l++})),l>0?i.find(".charitable-social-linking-no-links").addClass("charitable-hidden"):i.find(".charitable-social-linking-no-links").removeClass("charitable-hidden")},photoFieldEvents:function(e){var t;a.formfield="",e.on("click",".charitable-campaign-builder-upload-button",(function(e){e.preventDefault();var i=$(this),l=$(this).closest(".charitable-panel-field").data("field-id");a.formfield=$(this).parent().prev(),a.field_id=l,t||((t=wp.media.frames.file_frame=wp.media({title:i.data("uploader_title"),library:{type:"image"},button:{text:i.data("uploader_button_text")},multiple:!1})).on("menu:render:default",(function(e){e.unset("library-separator"),e.unset("gallery"),e.unset("featured-image"),e.unset("embed"),e.set({})})),t.on("select",(function(){t.state().get("selection").each((function(e,t){e=e.toJSON(),a.formfield.val(e.url),d.updateImagePhotoPreview(a.field_id,e.url),a.field_id=!1}))}))),t.open()})),e.on("click",".charitable-campaign-builder-clear-button",(function(e){e.preventDefault();const a=$(this),t=$(this).closest(".charitable-panel-field").data("field-id");a.closest(".charitable-internal").find('input[type="url"]').val(""),d.updateImagePhotoPreview(t,!1)}))},updateImagePhotoPreview:function(e=0,a=""){const t=$("#charitable-field-"+e),i=t.find("img.charitable-campaign-builder-preview-photo");!1!==a&&""!==a&&d.isValidURL(a)?(t.find("i.temp-icon").remove(),i.length>0?i.attr("src",a):(t.find(".primary-image-container .primary-image").append('<img src="'+a+'" class="charitable-campaign-builder-preview-photo" />'),t.find(".primary-image-container").addClass("has-image"))):(t.find(".primary-image-container .primary-image img").remove(),t.find(".primary-image-container .primary-image").append('<img src="../../images/campaign-builder/fields/photo/temp-icon.svg" class="temp-icon" alt="" />'),t.find(".primary-image-container").removeClass("has-image"))},isValidURL:function(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)},resetPreviewArea:function(){n.$formPreview.find(".charitable-field").each((function(){$(this).removeClass("active")})),$(".charitable-select-field-notice").show(),$(".charitable-layout-options-tab-general .charitable-panel-field").removeClass("active"),$("#charitable-preview-tab-container").removeClass("active")},fieldDelete:function(e,a=!0){var t=$("#charitable-field-"+e),i=t.data("field-type");t.hasClass("no-delete")?d.youCantRemoveFieldPopup():a?d.confirmFieldDeletion(e,i):d.fieldDeleteById(e,i)},confirmFieldDeletion:function(e,a){var t={id:e,message:charitable_builder.delete_confirm};CharitableUtils.triggerEvent(i,"charitableBeforeFieldDeleteAlert",[t,a]).isDefaultPrevented()||$.confirm({title:!1,content:t.message,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){d.fieldDeleteById(e,a)}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})},confirmCampaignDeletion:function(){i.on("click",".charitable-button.alert.delete-campaign",(function(e){e.preventDefault(),$.alert({title:!1,content:charitable_builder.campaign_delete_confirm,icon:"fa fa-info-circle",type:"red",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})}))},fieldDeleteById:function(e=!1,a="",t=200){!1!==e&&$(`#charitable-field-${e}`).fadeOut(t,(function(){const a=$(this),t=a.closest(".charitable-field-section"),l=a.data("field-type"),r=void 0!==a.data("field-max")?parseInt(a.data("field-max")):99;i.trigger("charitableBeforeFieldDelete",[e,l]),a.remove(),$("#charitable-field-option-"+e).remove(),$(".charitable-field, .charitable-preview-top-bar").removeClass("active"),$('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+e+'"]').remove(),$(".charitable-select-field-notice").show(),d.checkNoFieldsPreview(),d.checkFieldTargetState(t),(0===r||n.$preview.find(".charitable-field.charitable-field-donate-amount").length<r)&&$("#charitable-panel-design button#charitable-add-fields-donate-amount").removeClass("charitable-disabled"),d.checkIfTabsAreEmpty(),$(".charitable-layout-options-tab.charitable-layout-options-tab-general").hasClass("active")&&d.fieldTabToggle("add-layout");const o=$(".charitable-field-option"),c=i.find(".charitable-field-submit");o.length<1&&(n.$sortableFieldsWrap.append(n.$noFieldsPreview.clone()),n.$fieldOptions.append(n.$noFieldsOptions.clone()),c.hide()),o.filter(":not(.charitable-field-option-layout)").length||c.hide(),d.checkFieldAllow(),d.checkFieldMax(l,r),d.checkRecommendedFields(l),wpCookies.get("charitable_panel_active_field_id")===e&&wpCookies.set("charitable_panel_active_field_id","",2592e3),d.setCampaignNotSaved(),i.trigger("charitableFieldDelete",[e,l])}))},fieldEdit:function(e,a,t,l,n){"general"!==a&&"standard"!==a&&"pro"!==a&&"recommended"!==a||(d.panelSwitch("design"),$(".charitable-select-field-notice").hide(),$(".charitable-layout-options-tab-general .charitable-panel-field").removeClass("active"),$('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+l+'"]').addClass("active"),$('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+l+'"]').find("input[type=text],input[type=button],input[type=range],input[type=url],textarea,select").filter(":visible:first").focus(),"html"===n?CharitableCampaignBuilderFieldHTML.codemirrorInit(l):i.trigger("charitableFieldEdit",[e,a,t,l,n]))},fieldDuplicate:function(e){const a=$(`#charitable-field-${e}`);a.hasClass("no-duplicate")?$.alert({title:charitable_builder.field_locked,content:charitable_builder.field_locked_no_duplicate_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:charitable_builder.close,btnClass:"btn-confirm",keys:["enter"]}}}):$.confirm({title:!1,content:charitable_builder.duplicate_confirm,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){this.$$confirm.prop("disabled",!0);if(CharitableUtils.triggerEvent(i,"charitableBeforeFieldDuplicate",[e,a]).isDefaultPrevented())return;const t=d.fieldDuplicateRoutine(e),l=$(`#charitable-field-${t}`);CharitableUtils.triggerEvent(i,"charitableFieldDuplicated",[e,a,t,l])}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})},fieldDuplicateRoutine:function(e){const a=$(`#charitable-field-${e}`),t=n.$sortableFieldsWrap.find("> .active"),i=n.$sortableFieldsWrap.find("> .active"),l=a.clone(),r=parseInt(n.$nextFieldId.val(),10)+1,o=$('#charitable-field-options .charitable-layout-options-group-inner .charitable-panel-field[data-field-id="'+e+'"]');return l&&d.updateFormHiddenFieldID(r),a.after(l),t.removeClass("active"),i.removeClass("active"),l.addClass("active").attr({id:`charitable-field-${r}`,"data-field-id":r}),o.each((function(){var a=$(this).clone(),t=a.text().indexOf("ID:")>-1;if(a.attr("data-field-id",r),$(this).removeClass("active"),a.addClass("active"),t&&a.text((function(a,t){return t.replace("ID: "+e,"ID: "+r)})),void 0!==a.attr("name")&&a.attr("name").length>0&&a.attr("name",a.attr("name").replace(e,r)),void 0!==a.attr("id")&&a.attr("id").length>0&&a.attr("id",a.attr("id").replace(e,r)),a.find("*").each((function(){var t=$(this);void 0!==t.attr("for")&&t.attr("for").length>0&&t.attr("for",t.attr("for").replace(e,r)),void 0!==t.attr("name")&&t.attr("name").length>0&&t.attr("name",t.attr("name").replace(e,r)),void 0!==t.attr("id")&&t.attr("id").length>0&&t.attr("id",t.attr("id").replace(e,r)),void 0!==t.data("field-id")&&t.data("field-id").length>0&&a.attr("data-field-id",r)})),a.find(".charitable-toggle-control").attr("data-field-id",r),a.find(".charitable-checkbox-for-toggle").attr("data-field-id",r),$("#charitable-field-options .charitable-layout-options-tab-general .charitable-layout-options-group-inner").append(a),void 0!==a.data("special-type")&&"campaign_description"===a.data("special-type")){let e=a.find(".campaign-builder-htmleditor .ql-editor").html();a.find(".ql-toolbar").remove(),a.find(".campaign-builder-htmleditor").html('<div data-textarea-name="_fields['+r+'][content]" id="charitable-panel-field-settings-field_campaign-description_html_'+r+'" class="campaign-builder-htmleditor">'+e+"</div>"),d.initHTMLEditorFields(a.find(".campaign-builder-htmleditor"),!1)}d.checkFieldAllow(),d.checkFieldMax()})),r},focusOutEvent:function(){null!==n.$focusOutTarget&&(n.$focusOutTarget=null)},isFormPreviewActionsDisabled:function(e){return $(e).closest(".charitable-field-wrap").hasClass("ui-sortable-disabled")},fieldGroupTogglev2:function(e,a){var t=$(e),i=t.closest(".charitable-group").data("group_id"),l=t.closest(".charitable-group"),n=l.find(".charitable-group-rows"),r=(n.parent(),t.find("i")),o="charitable_panel_layout_options_tabs_tab_open_"+i;if("click"===a)return r.toggleClass("charitable-angle-right"),void n.stop().slideToggle("",(function(){l.toggleClass("charitable-closed"),l.hasClass("charitable-closed")?(l.removeClass("charitable-open"),wpCookies.remove(o)):wpCookies.set(o,"true",2592e3)}))},fieldGroupTogglev3:function(e,a="click"){var t=$(e),i=t.closest(".charitable-add-fields-group"),l=i.find(".charitable-group-rows"),n="charitable_panel_add_layout_blocks_open_test";if("click"===a)return t.toggleClass("charitable-angle-right"),void l.stop().slideToggle("",(function(){i.toggleClass("charitable-closed"),i.hasClass("charitable-closed")?(i.removeClass("charitable-open"),wpCookies.remove(n)):wpCookies.set(n,"true",2592e3)}))},fieldGroupToggle:function(e,a){var t=$(e),i=t.next(".charitable-add-fields-buttons"),l=i.parent(),n=t.find("i"),r=t.data("group"),o="charitable_field_group_"+r;if("general-layout-campaign"!=r&&"general-layout-faq"!=r||(i=l=t.parent().find(".charitable-"+r+"-group-inner")),"click"===a)return l.hasClass("charitable-closed")?wpCookies.remove(o):wpCookies.set(o,"true",2592e3),n.toggleClass("charitable-angle-right"),void i.stop().slideToggle("",(function(){l.toggleClass("charitable-closed")}));"load"===a&&(i=t.find(".charitable-add-fields-buttons"),n=t.find(".charitable-add-fields-heading i"),o="charitable_field_group_"+(r=t.find(".charitable-add-fields-heading").data("group")),"true"===wpCookies.get(o)&&(n.toggleClass("charitable-angle-right"),i.hide(),t.toggleClass("charitable-closed")))},fieldMove:function(e,a){var t=a.field;t.find(".charitable-field-edit").click(),i.find(".charitable-add-fields .charitable-add-fields-button").prop("disabled",!1);var l=t.closest(".charitable-field-section");d.checkFieldTargetState(l),a.section&&d.checkFieldTargetState(a.section),i.trigger("charitableFieldMove",[a.fieldId,e])},fieldAdd:function(e,a){$(`#charitable-add-fields-${e}`);o=!0,Charitable.Admin.Builder.DragFields.disableDragAndDrop(),d.disableFormActions();let l={campaign_title:t.campaignTitle,position:"bottom",$sortable:"base",placeholder:!1,scroll:!0,defaults:!1,column_id:a.column_id,tab_id:a.tab_id,section_id:a.section_id,area:"fields"};a=$.extend({},l,a);let r={action:"charitable_new_field_"+e,id:t.formID,column_id:a.column_id,tab_id:a.tab_id,section_id:a.section_id,field_id:parseInt(n.$nextFieldId.val())+1,type:e,campaign_title:a.campaign_title,defaults:a.defaults,nonce:charitable_builder.nonce};return $.post(charitable_builder.ajax_url,r,(function(l){if(!l.success)return void wpchar.debug("Add field AJAX call is unsuccessful:",l);wpchar.debug("fieldAdd return"),d.refreshTabFieldsSortDrag();let c="tabs"===a.area?n.$sortableTabContent.find('li[data-tab-id="'+r.tab_id+'"] .charitable-tab-wrap'):n.$formPreview.find('.charitable-field-wrap[data-section-id="'+r.section_id+'"]');wpchar.debug(c);const s=$(l.data.preview),p=void 0!==l.data.max?parseInt(l.data.max):99,h=$(l.data.options);let b=a.$sortable;o=!1,s.css("display","none"),a.placeholder&&a.placeholder.remove(),"default"!==a.$sortable&&a.$sortable.length||(b=c.find(".charitable-fields-sortable-default")),"base"!==a.$sortable&&b.length||(b=c);let u=CharitableUtils.triggerEvent(i,"charitableBeforeFieldAddToDOM",[a,s,h,b]);if(!u.isDefaultPrevented()){u.skipAddFieldToBaseLevel||d.fieldAddToBaseLevel(a,s,h),n.$preview.find(".charitable-field.charitable-field-donate-amount").length>=p&&$("#charitable-panel-design button#charitable-add-fields-donate-amount").addClass("charitable-disabled"),s.fadeIn(),d.checkFieldTargetState($('.charitable-field-section[data-section-id="'+r.section_id+'"]')),s.find(".charitable-field-edit").click(),$(".charitable-field-option:not(.charitable-field-option-layout)").length&&i.find(".charitable-field-submit").show(),d.updateFormHiddenFieldID(l.data.field_id),""!==l.data.edit_field_html&&($(".charitable-layout-options-tab-general .charitable-layout-options-group-inner").append(l.data.edit_field_html).find('.charitable-panel-field[data-field-id="'+l.data.field_id+'"]').addClass("active"),""!=l.data.html_field&&$('.charitable-panel-field[data-field-id="'+l.data.field_id+'"]').find(".campaign-builder-htmleditor").each((function(){d.initHTMLEditorFields($(this),!1)})),"campaign-description"===e&&void 0!==t.campaignDescription&&(s.find(".charitable-campaign-builder-no-description-preview").html("<div>"+t.campaignDescription+"</div>"),0===$("#charitable-panel-field-settings-field_campaign-description_html_"+r.field_id).find(".ql-editor").length&&d.initHTMLEditorFields($("#charitable-panel-field-settings-field_campaign-description_html_"+r.field_id)),$("#charitable-panel-field-settings-field_campaign-description_html_"+r.field_id).find(".ql-editor").html(t.campaignDescription))),"organizer"===l.data.field.type&&$('.campaign-builder-campaign-creator-id-mini[data-field-id="'+l.data.field_id+'"] select').select2({templateResult:d.campaignCreatorFormatOptions}),wpchar.initTooltips(),d.checkFieldAllow(),d.checkFieldMax(),d.updateEndDateRelatedItems(),d.updateGoalRelatedItems(),d.checkRecommendedFields(e);var m=b.data("section-type");void 0!==m&&"fields"===m&&!0,d.checkNoFieldsPreview(),"photo"===e?$('.charitable-panel-field-uploader[data-field-id="'+l.data.field_id+'"] input.charitable-campaign-builder-upload-button').click():"donate-amount"===e&&$(".charitable-campaign-suggested-donations-mini").each((function(){d.initSuggestedDonationsMini($(this)),d.updateSuggestdDonationsMiniRowsFromSettings($(this))})),i.trigger("charitableFieldAdd",[l.data.field.id,e])}})).fail((function(e,a,t){o=!1})).always((function(){i.find(".charitable-add-fields .charitable-add-fields-button").prop("disabled",!1),o||(Charitable.Admin.Builder.DragFields.enableDragAndDrop(),d.enableFormActions())}))},fieldAddToBaseLevel:function(e,a,t){wpchar.debug("options"),wpchar.debug(e);let i="";"tabs"===e.area?(i=n.$sortableTabContent.find('li[data-tab-id="'+e.tab_id+'"] .charitable-tab-wrap'),i.parent().removeClass("empty-tab")):i=n.$formPreview.find('.charitable-field-wrap[data-section-id="'+e.section_id+'"]'),wpchar.debug("baseFieldsContainer"),wpchar.debug(i);const l=i.find("> :not(.charitable-field-drag-pending)"),r=l.last(),o=l.length;let d=n.$fieldOptions;return"top"===e.position?(wpchar.debug("made it here 1"),void i.prepend(a)):"bottom"!==e.position||r.length&&r.hasClass("charitable-field-stick")?("bottom"===e.position&&(wpchar.debug("made it here 2"),e.position=o),e.position===o&&r.length&&r.hasClass("charitable-field-stick")?(wpchar.debug("made it here 3"),void r.before(a)):(d=i.children(":not(.charitable-field-drag-pending)").eq(e.position),d.length?(wpchar.debug("made it here ALMOST final with position "+e.position),wpchar.debug(d),wpchar.debug(d.length),void d.before(a)):(wpchar.debug("made it here final"),void i.append(a)))):(wpchar.debug("adding field to the bottom!!!!"),void i.append(a))},checkIfTabsAreEmpty:function(){n.$preview.find(".tab-content ul li.tab_content_item").each((function(){0===$(this).find(".charitable-field").length&&$(this).addClass("empty-tab")}))},disableFormActions:function(e=!1,a=!0,t=!1){$.each([n.$embedButton,n.$statusButton,n.$saveButton],(function(e,a){a.prop("disabled",!0).addClass("charitable-disabled")})),e&&$.each([n.$exitButton],(function(e,a){a.prop("disabled",!0).addClass("charitable-disabled")})),a&&($(".charitable-edit-campaign-title-area").addClass("charitable-disabled"),$(".charitable-edit-campaign-title-area input").prop("disabled",!0),$(".charitable-edit-campaign-title-area a").addClass("charitable-disabled")),t&&n.$previewButton.prop("disabled",!0).addClass("charitable-disabled")},enableFormActions:function(){$.each([n.$statusButton,n.$saveButton,n.$exitButton],(function(e,a){a.prop("disabled",!1).removeClass("charitable-disabled")})),$(".charitable-edit-campaign-title-area").removeClass("charitable-disabled"),$(".charitable-edit-campaign-title-area input").prop("disabled",!1),$(".charitable-edit-campaign-title-area a").removeClass("charitable-disabled"),"publish"===t.formStatus&&n.$embedButton.prop("disabled",!1).removeClass("charitable-disabled")},fieldChoiceDeleteAlert:function(){$.alert({title:!1,content:charitable_builder.error_choice,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},fieldChoiceSortable:function(e,a){$(a=void 0!==a?a:".charitable-field-option-"+e+" .charitable-field-option-row-choices ul").sortable({items:"li",axis:"y",delay:100,opacity:.6,handle:".move",stop:function(a,t){var l=t.item.parent().data("field-id");d.fieldChoiceUpdate(e,l),i.trigger("charitableFieldChoiceMove",t)},update:function(e,a){}})},tabDelete:function(e){d.confirmTabDeletion(e)},confirmTabDeletion:function(e){var a={id:e,message:charitable_builder.delete_tab_confirm};CharitableUtils.triggerEvent(i,"charitableBeforeTabDeleteAlert",[a]).isDefaultPrevented()||$.confirm({title:!1,content:charitable_builder.delete_tab_confirm,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){d.tabDeleteById(e)}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})},tabDeleteById:function(e){const a=n.$fieldOptions.find('[data-group_id="'+e+'"]'),t=$("nav ul li#tab_"+e+"_title"),i=n.$preview.find('.tab-content ul li.tab_content_item[data-tab-id="'+e+'"]'),l=n.$preview.find(".tab-content .tab_content_item").length-1,r=Math.abs(e-1),o=n.$preview.find(".tab-content");a.remove(),t.remove(),i.remove(),n.$preview.find('nav.charitable-campaign-preview-nav ul li[data-tab-id="'+r+'"] a').length>0?n.$preview.find('nav.charitable-campaign-preview-nav ul li[data-tab-id="'+r+'"] a').click():1===l&&n.$preview.find("nav.charitable-campaign-preview-nav ul li a").first().click(),0===l?(o.addClass("empty-tabs"),o.append('<p class="no-tab-notice">'+charitable_builder.no_tabs+"</p>")):(o.removeClass("empty-tabs"),o.find(".no-tab-notice").remove()),d.checkHideTabNavigation()},bindUIActionsPreview:function(){$("body").on("click","a#charitable-preview-btn",(function(e){if(e.preventDefault(),e.stopPropagation(),0!==parseInt(n.$campaignID.val())){var a="";void 0!==this.href&&(a=this.href.replace("charitable_campaign_preview=0","charitable_campaign_preview="+t.campaignID)),(void 0!==t.formStatus&&"publish"===t.formStatus||void 0!==t.formStatus&&"draft"===t.formStatus)&&d.formSave(!1,!0,a)}else $.alert({title:charitable_builder.no_preview_must_save,content:charitable_builder.no_preview_must_save_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:charitable_builder.close,btnClass:"btn-confirm",keys:["enter"]}}})}))},bindUIActionsSaveExit:function(){i.on("click","#charitable-embed",(function(e){e.preventDefault(),e.stopPropagation(),$(this).hasClass("charitable-disabled")||CharitableCampaignEmbedWizard.openPopup(t.formID)})),i.on("click","#charitable-status-button",(function(e){e.preventDefault(),e.stopPropagation(),$(this).hasClass("charitable-disabled")||($(this).hasClass("active")?($(this).parent().find("ul#charitable-status-dropdown").addClass("charitable-hidden"),$(this).removeClass("active")):($(this).parent().find("ul#charitable-status-dropdown").removeClass("charitable-hidden"),$(this).addClass("active")))})),i.on("click","ul#charitable-status-dropdown a",(function(e){if(e.preventDefault(),e.stopPropagation(),!$("#charitable-status-button").hasClass("charitable-disabled")){var a=$(this).data("status"),i=$(this).data("status-label"),l=$("ul#charitable-status-dropdown")
;l.addClass("charitable-hidden"),$("#charitable-status-button").removeClass("active"),$("#charitable-status-button span.text").html(i),$("#charitable-status-button").attr("data-status",a),l.find("a").removeClass("charitable-hidden"),l.find("a.switch-"+a).addClass("charitable-hidden"),l.find("a."+a).addClass("charitable-hidden"),t.formStatus=a,t.formStatusLabel=i}})),i.on("click",(function(e){!1===$(e.target).is("#charitable-status-dropdown")&&($("ul#charitable-status-dropdown").addClass("charitable-hidden"),$("#charitable-status-button").removeClass("active"))})),i.on("click","#charitable-save",(function(e){e.preventDefault(),d.formSave(!1)})),i.on("click","#charitable-exit",(function(e){e.preventDefault(),d.formExit()})),i.on("charitableSaved",(function(e,a){$("#charitable_settings_title").attr("disabled",!0),wpchar.removeQueryParam("newform")}))},updateFormID:function(){var e={action:"charitable_get_campaign_form_id",id:t.formID,nonce:charitable_builder.nonce};return $.post(charitable_builder.ajax_url,e,(function(e){if(e.success){var a=e.data.campaign_id;$("form#charitable-builder-form").attr("data-id",a),$('form#charitable-builder-form input[name="id"]').val(a),e.data.field_id&&n.$nextFieldId.val(parseInt(e.data.field_id)),wpchar.savedState=wpchar.getFormState("#charitable-builder-form"),wpchar.initialSave=!1,i.trigger("charitableSaved",e.data),d.updateDebugWindow(e.data,e.data.campaign_id)}else d.formSaveError(e.data)})).fail((function(e,a,t){d.formSaveError()})).always((function(){}))},updateFormHiddenFields:function(){$('#charitable-panel-design .charitable-panel-content-wrap input[type="hidden"]').remove(),$(".charitable-field-wrap .charitable-field, .charitable-tab-wrap .charitable-field").each((function(){var e=$(this).closest(".row").data("row-type"),a=$(this).closest(".row").data("row-id"),t=$(this).closest(".row").data("row-css").length>0?$(this).closest(".row").data("row-css"):"no-css",i=$(this).closest(".column.charitable-field-column").data("column-id"),l=$(this).closest(".section.charitable-field-section").data("section-type"),r=$(this).closest(".section.charitable-field-section").data("section-id"),o=$(this).data("field-id"),d="tabs"===l&&$(this).closest("li.tab_content_item").data("tab-id");void 0!==a&&("tabs"===l?n.$formPreview.append('<input type="hidden" name="layout[row][row-type-'+e+"]["+a+"]["+t+"][column]["+i+"][section][section-type-"+l+"]["+r+"][tabs]["+d+"][fields]["+o+']" value="'+$(this).data("field-type")+'" />'):n.$formPreview.append('<input type="hidden" name="layout[row][row-type-'+e+"]["+a+"]["+t+"][column]["+i+"][section][section-type-"+l+"]["+r+"][fields]["+o+']" value="'+$(this).data("field-type")+'" />'))}))},updateFormHiddenFieldID:function(e=0){if(0===e){var a=0;n.$formPreview.find(".charitable-field").each((function(){var e=parseFloat($(this).attr("data-field-id"));a=e>a?e:a})),e=a}n.$nextFieldId.val(parseInt(e))},updatePreviewLink:function(e=""){n.$previewButton.attr("href",e)},updateSuggestDonationsSettings:function(e,a){e.is("input")&&"text"===d.getInputType(e)&&($("table#campaign_donation_amounts tbody").find('input[type="text"].campaign_suggested_donations').eq(a).val(e.val()),$(".charitable-campaign-suggested-donations-mini tbody").find('input[type="text"].campaign_suggested_donations').eq(a).val(e.val()),n.$preview.find(".charitable-field-donate-amount li.charitable-preview-donation-amount").eq(a/2-1).find("span").first().html(e.val()))},updateAllowCustomDonationSettings:function(e){const a=n.$preview.find(".charitable-preview-donation-options .custom-donation-amount");e?a.removeClass("charitable-hidden"):a.addClass("charitable-hidden")},updateSuggestedDonationAmountDefault:function(e=0){e>0?($('input[type="radio"].campaign_suggested_donations').prop("checked",!1),$('input[type="radio"][value='+e+"].campaign_suggested_donations").prop("checked",!0),n.$preview.find(".charitable-field.charitable-field-donate-amount li").removeClass("selected"),n.$preview.find(".charitable-preview-donation-amounts li:nth-child("+e+")").addClass("selected"),n.$preview.find('.charitable-field.charitable-field-donate-amount input[type="radio"]').length>0&&n.$preview.find('.charitable-field.charitable-field-donate-amount input[type="radio"]:eq('+(e-1)+")").prop("checked",!0)):$("input:radio].campaign_suggested_donations").prop("checked",!1)},getInputType:function(e){var a=e;return"input"===a[0].tagName.toString().toLowerCase()?$(a[0]).prop("type").toLowerCase():a[0].tagName.toLowerCase()},updateCampaignCreatorInfo:function(){var e={action:"charitable_update_campaign_creator",creator_id:parseInt($("select#charitable-panel-field-settings-campaign_campaign_creator_id").val()),campaign_id:t.formID,nonce:charitable_builder.nonce};return $.post(charitable_builder.ajax_url,e,(function(e){e.success?($("#campaign-creator .charitable-campaign-creator-avatar img").attr("src",e.data.avatar_url),$("#campaign-creator h3.creator-name").html(e.data.creator_name),$("#campaign-creator p.joined-on span").html(e.data.joined_on),$("#campaign-creator a.public-profile-link").attr("href",e.data.public_profile_link),$("#campaign-creator a.edit-profile-link").attr("href",e.data.edit_profile_link)):d.formSaveError(e.data)})).fail((function(e,a,t){d.formSaveError()})).always((function(){}))},formSave:function(e,l=!1,r="",o=!1){var c=n.$saveButton,s=c.find("img.topbar_icon"),p=c.find("i.charitable-loading-spinner"),h=c.find("span"),b=t.formSavedStatus;if(!i.hasClass("charitable-is-revision")||i.hasClass("charitable-revision-is-saving")){if("undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),!CharitableUtils.triggerEvent(i,"charitableBeforeSave").isDefaultPrevented()){$("#charitable_settings_title").removeAttr("disabled"),c.prop("disabled",!0),!1===l&&(h.text(charitable_builder.saving),s.addClass("charitable-hidden"),p.removeClass("charitable-hidden")),d.updateFormHiddenFields();var u={action:"charitable_save_campaign",data:JSON.stringify($("#charitable-builder-form").serializeArray()),id:t.formID,status:t.formStatus,statusLabel:t.formStatusLabel,preview:l,nonce:charitable_builder.nonce};return $.post(charitable_builder.ajax_url,u,(function(c){if(c.success){var s=parseInt(c.data.campaign_id);if(o)return a.location.href,d.addCampaignIDToURL(s),void(a.location.href=d.addCampaignIDToURL(s));if($("form#charitable-builder-form").attr("data-id",s),$('form#charitable-builder-form input[name="id"]').val(s),t.formID=s,c.data.field_id&&n.$nextFieldId.val(parseInt(c.data.field_id)),wpchar.savedState=wpchar.getFormState("#charitable-builder-form"),wpchar.initialSave=!1,i.trigger("charitableSaved",c.data),d.updateDebugWindow(c.data,c.data.campaign_id),void 0!==c.data.preview_url&&c.data.preview_url.length>0&&d.updatePreviewLink(c.data.preview_url),!1===l&&d.setCampaignSaved(),!0===e&&(a.location.href=charitable_builder.exit_url),history.pushState){var p=d.addCampaignIDToURL(s);a.history.pushState({path:p},"",p)}else a.location.href=d.addCampaignIDToURL(s);t.campaignID=s,"draft"!==b&&""!==b||"publish"!==c.data.post_status||!c.data.permalink||CharitableCampaignCongratsWizard.openPopup(t.formID,c.data.permalink),"publish"===c.data.post_status?(n.$viewCampaignButton.removeClass("charitable-disabled"),n.$viewCampaignButton.attr("href",c.data.permalink),$("a.charitable-admin-campaign-link").attr("href",c.data.permalink),$("a.charitable-admin-campaign-link.show-url").html(c.data.permalink)):n.$viewCampaignButton.addClass("charitable-disabled"),"publish"===c.data.post_status?n.$embedButton.prop("disabled",!1).removeClass("charitable-disabled"):n.$embedButton.prop("disabled",!0).addClass("charitable-disabled"),t.formSavedStatus=c.data.post_status,t.formSavedStatusLabel=c.data.post_status_label,""!==r&&a.open(r);var h="[campaign id=&quot;"+s+"&quot;]";return $("#charitable-admin-campaign-embed-wizard-shortcode-wrap #charitable-admin-campaign-embed-wizard-shortcode").remove(),$("#charitable-admin-campaign-embed-wizard-shortcode-wrap").prepend('<input type="text" id="charitable-admin-campaign-embed-wizard-shortcode" class="charitable-admin-popup-shortcode" value="'+h+'" />'),$("#charitable-admin-campaign-embed-wizard-shortcode").prop("disabled",!0),d.addCampaignIDToURL(s)}d.formSaveError(c.data)})).fail((function(e,a,t){d.formSaveError()})).always((function(){h.text(charitable_builder.saved),setTimeout((function(){h.text(charitable_builder.save)}),2500),c.prop("disabled",!1),p.addClass("charitable-hidden"),s.removeClass("charitable-hidden")}))}}else d.confirmSaveRevision()},formSaveError:function(e){wpchar.empty(e)&&(e=charitable_builder.error_save_form),$.confirm({title:charitable_builder.heads_up,content:"<p>"+e+"</p><p>"+charitable_builder.error_contact_support+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},formGenericError:function(e){wpchar.empty(e)&&(e=charitable_builder.something_went_wrong),$.confirm({title:charitable_builder.heads_up,content:"<p>"+e+"</p><p>"+charitable_builder.error_contact_support+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},formGenericNotice:function(e){wpchar.empty(e)&&(e=charitable_builder.something_went_wrong),$.confirm({title:charitable_builder.heads_up,content:"<p>"+e+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},addCampaignIDToURL:function(e){const t=a.location.href;let i=!1;if(t.includes("?")){return a.location.search.includes("campaign_id")?(i=t.split("#")[0],i):(i=t.split("#")[0],i+"&campaign_id="+e)}return t+"?campaign_id="+e},fieldTabToggle:function(e){if(CharitableUtils.triggerEvent(i,"charitableFieldTabToggle",[e]).isDefaultPrevented())return!1;$(".charitable-tab a").removeClass("active"),$(".charitable-field, .charitable-preview-top-bar").removeClass("active"),"add-layout"===e?($("#add-layout a").addClass("active"),$(".charitable-field-options").hide(),$(".charitable-add-fields").show()):"layout-options"===e?($("#layout-options a").addClass("active"),$(".charitable-add-fields").hide(),$(".charitable-field-options").show()):($("#charitable-field-"+e).addClass("active"),$(".charitable-field-option").hide(),$("#charitable-field-option-"+e).show(),$(".charitable-add-fields").hide(),$(".charitable-field-options").show(),i.trigger("charitableFieldOptionTabToggle",[e])),wpCookies.set("charitable_panel_content_section",e,2592e3),wpCookies.set("charitable_panel_active_field_id","",2592e3),wpCookies.set("charitable_panel_design_layout_options_group","",2592e3),wpCookies.set("charitable_panel_tab_section_tab_id","",2592e3)},formExit:function(){d.formIsSaved()?a.location.href=charitable_builder.exit_url:$.confirm({title:!1,content:charitable_builder.exit_confirm,icon:"fa fa-exclamation-circle",type:"orange",closeIcon:!0,buttons:{confirm:{text:charitable_builder.save_exit,btnClass:"btn-confirm",keys:["enter"],action:function(){d.formSave(!0)}},cancel:{text:charitable_builder.exit,keys:["esc"],action:function(){r=!1,a.location.href=charitable_builder.exit_url}}}})},checkFieldMax:function(e="",a=99){0===e.length?n.$preview.find(".charitable-field-"+e).length<a&&n.$panelDesign.find("button#charitable-add-fields-"+e).removeClass("charitable-disabled"):n.$preview.find(".charitable-field[data-field-max!='']").each((function(){var e=parseInt($(this).data("field-max")),a=$(this).data("field-type"),t=void 0===a||0===a.length?0:n.$preview.find(".charitable-field-"+a).length;!isNaN(e)&&e>0&&t>=e&&n.$panelDesign.find("button#charitable-add-fields-"+a).addClass("charitable-disabled")}))},checkFieldAllow:function(){wpchar.debug("checkFieldAllow"),$.each(t.denyList,(function(e,a){$.each(a,(function(e,a){d.enableAddFieldButton(e)}))})),$.each(t.denyList,(function(e,a){wpchar.debug("fieldPresent: "+e),d.checkFieldIsPresent(e)&&$.each(a,(function(e,a){(0===a||d.getFieldAmount(e)>parseInt(a))&&(wpchar.debug(e+" is not allowed"),d.disableAddFieldButton(e))}))}))},checkAllRecommendedFields:function(){$.each($(".charitable-add-fields-group-recommended button"),(function(){var e=$(this).data("field-type");d.checkRecommendedFields(e)}))},checkRecommendedFields:function(e=!1){if(e&&0!==e.length){var a=n.$preview.find(".charitable-field[data-field-type='"+e+"']").length,t=i.find("#charitable-add-fields-"+e).parent().find(".charitable-check");void 0!==t&&0!==t.length&&(0===a?t.removeClass("checked").addClass("unchecked"):t.removeClass("unchecked").addClass("checked"))}},disableAddFieldButton:function(e){n.$panelDesign.find("button#charitable-add-fields-"+e).addClass("charitable-disabled")},enableAddFieldButton:function(e=""){n.$panelDesign.find("button#charitable-add-fields-"+e).removeClass("charitable-disabled")},getFieldAmount:function(e=""){if(0!==e.length)return n.$preview.find(".charitable-field-"+e).length},checkFieldIsPresent:function(e=""){return 0!==e.length&&d.getFieldAmount(e)>0},setCloseConfirmation:function(e){r=!!e},formIsSaved:function(){return 0===$("#charitable-builder-form input#charitable-form-saved").val().length&&void 0!==t.formSaved&&0===t.formSaved.length},setCampaignNotSaved:function(e=!1){var a=Date.now();$("#charitable-builder-form input#charitable-form-saved").val(a),t.formSaved=a,n.$previewButton.removeClass("charitable-disabled")},setCampaignSaved:function(){$("#charitable-builder-form input#charitable-form-saved").val(""),t.formSaved="",void 0!==t.formStatus&&"publish"===t.formStatus?n.$previewButton.addClass("charitable-disabled"):n.$previewButton.removeClass("charitable-disabled")},bindUIMoneyTextFields:function(){i.on("keydown","input#charitable-panel-field-settings-campaign_minimum_donation_amount, input#charitable-panel-field-settings-campaign_goal",(function(e){var a=e.keyCode||e.which;190==a||188==a||32==a||9==a||8==a||e.ctrlKey&&65==a||e.ctrlKey&&67==a||e.ctrlKey&&88==a||e.ctrlKey&&86==a||e.metaKey&&65==a||e.metaKey&&67==a||e.metaKey&&88==a||e.metaKey&&86==a||a>=96&&a<=105||110==a||190==a||a>=37&&a<=40||46==a||a>=48&&a<=57||e.preventDefault()})),i.on("focusout","input#charitable-panel-field-settings-campaign_minimum_donation_amount, input#charitable-panel-field-settings-campaign_goal",(function(e){var a=$(this),t=a.val();t.length>0&&-1===t.indexOf(".")&&a.val(t+".00")}))},bindUISettingsRevealGroups:function(){$.each(n.$settingsPanel.find(".charitable-panel-fields-group.unfoldable"),(function(){var e=$(this),a=e.attr("data-group");"true"!==wpCookies.get("charitable_fold_"+a)||e.hasClass("opened")||(e.addClass("opened"),e.find(".charitable-panel-fields-group-inner").show())})),n.$settingsPanel.on("click",".charitable-track-cookie",(function(e){var a=$(this),t=a.closest(".unfoldable").attr("data-group");a.closest(".unfoldable").hasClass("opened")?wpCookies.remove("charitable_fold_"+t):wpCookies.set("charitable_fold_"+t,!0,2592e3)}))},checkFieldConditionals:function(){$.each(charitable_campaign_builder_field_conditionals,(function(e,a){var t=n.$settingsPanel.find(e),i=a;t.is('input[type="checkbox"]')&&n.$settingsPanel.on("click",e,(function(e){$(this);var a=$(this).is(":checked"),t=i.checked,l=i.unchecked;a?$.each(t,(function(e,a){n.$settingsPanel.find(a+"").removeClass("charitable-hidden")})):$.each(l,(function(e,a){$.each(a,(function(e,a){n.$settingsPanel.find(a+"").addClass("charitable-hidden")}))}))})),t.is('input[type="radio"]')&&n.$settingsPanel.on("click",t.closest(".charitable-panel-field-radio-options").find('input[type="radio"]'),(function(e){var a=$(t).is(":checked"),l=i.checked,r=i.unchecked,o=!1;a?$.each(l,(function(e,a){"if"===e&&$.each(a,(function(e,a){"checked"===a&&!1===n.$settingsPanel.find(e+"").is(":checked")&&(o=!0)})),"show"===e&&!1===o?n.$settingsPanel.find(a+"").removeClass("charitable-hidden"):"show"===e&&!0===o&&n.$settingsPanel.find(a+"").addClass("charitable-hidden")})):$.each(r,(function(e,a){n.$settingsPanel.find(a+"").addClass("charitable-hidden")}))}))}))},isBuilderInPopup:function(){return a.self!==a.parent&&"charitable-builder-iframe"===a.self.frameElement.id},bindUIActionsGeneral:function(){i.on("click",".charitable-panel-fields-group.unfoldable .charitable-panel-fields-group-title",d.toggleUnfoldableGroup),i.on("click",".go-to-settings-button",(function(e){e.preventDefault(),d.panelSwitch("settings");var a=$(this).data("settings-section"),t=$(".charitable-panel-sidebar-content"),i=t.find(".charitable-panel-sidebar-section"),l=t.find(".charitable-panel-sidebar-section-"+a);l.hasClass("active")||(d.panelSectionSwitchTo(a,t,i,l),wpCookies.set("charitable_panel_sidebar_section",a,2592e3))})),i.on("click","#charitable-builder-mobile-notice .charitable-fullscreen-notice-button-primary, #charitable-builder-mobile-notice .close",(function(){a.location.href=charitable_builder.exit_url})),i.on("click","#charitable-builder-mobile-notice .charitable-fullscreen-notice-button-secondary",(function(){a.location.href=wpchar.updateQueryString("force_desktop_view",1,a.location.href)}))},initFeedbackForms:function(e){var a=e.closest(".charitable-form"),t=a.find(".charitable-feedback-form-interior-confirmation"),i={name:a.find(".charitable-feedback-form-name").val(),email:a.find(".charitable-feedback-form-email").val(),feedback:a.find(".charitable-feedback-form-feedback").val(),type:a.find(".charitable-feedback-form-type").val()};if(""===i.name||""===i.email||""===i.feedback)$.alert({title:!1,content:charitable_builder.feedback_form_fields_required,icon:"fa fa-info-circle",type:"red",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["esc"],action:function(){}}}});else{e.addClass("charitable-disabled"),a.addClass("charitable-processing"),a.find(".charitable-loading-spinner").removeClass("charitable-hidden");var l={action:"charitable_campaign_builder_send_feedback_ajax",dataType:"json",data:i,nonce:charitable_builder.nonce};$.post(charitable_builder.ajax_url,l,(function(i){i.success&&(e.removeClass("charitable-disabled"),a.removeClass("charitable-processing"),a.find(".charitable-feedback-form-interior").addClass("charitable-hidden"),t.removeClass("charitable-hidden"),t.find(".charitable-form-confirmation").removeClass("charitable-hidden"))})).fail((function(e,a,t){})).always((function(){}))}},toggleUnfoldableGroup:function(e){e.preventDefault();var a=$(e.target).closest(".charitable-panel-fields-group"),t=a.find(".charitable-panel-fields-group-inner"),i="charitable_fields_group_"+a.data("group");a.hasClass("opened")?(wpCookies.remove(i),t.stop().slideUp(150,(function(){a.removeClass("opened")}))):(wpCookies.set(i,"true",2592e3),a.addClass("opened"),t.stop().slideDown(150))},updateDebugWindow:function(e,a=0){var t={action:"charitable_update_debug_window_ajax",dataType:"json",data:e,id:a,nonce:charitable_builder.nonce};$.post(charitable_builder.ajax_url,t,(function(e){e.success&&$(".charitable-debug").html(e.data)})).fail((function(e,a,t){})).always((function(){}))},dismissNotice:function(){i.on("click",".charitable-alert-field-not-available .charitable-dismiss-button",(function(e){e.preventDefault();var a=$(this),t=a.closest(".charitable-alert"),i=a.data("field-id");t.addClass("out"),setTimeout((function(){t.remove()}),250),i&&$("#charitable-field-option-"+i).remove()}))},initHTMLEditorFields:function(e,a=!1){if(-1==$.inArray(e.attr("id"),t.quilled)){var i="#"+e.attr("id"),l=e.data("textarea-name");if(!1!==a){var r=new Quill(i,{debug:"info",theme:"snow",modules:{toolbar:["bold","italic","underline","strike"]}});$(i).css("height","200px"),$(i).css("min-height","200px"),r.focus,t.quilled.push(e.attr("id"))}else{(r=new Quill(i,{theme:"snow"})).focus,t.quilled.push(e.attr("id"))}$(i).on("focus",".ql-editor",(function(){var a=e.find(".ql-editor").html();"campaign_description"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&($("#charitable-panel-field-settings-campaign_description .ql-editor").html(a),n.$preview.find(".charitable-field-campaign-description .charitable-campaign-builder-placeholder-preview-text").html("<div>"+a+"</div>"),t.campaignDescription=a)})),r.on("text-change",(function(i,r,o){var c=e.find(".ql-editor").html(),s=e.closest(".charitable-group-row").data("tab-id"),p=e.closest(".charitable-panel-field").data("field-id");if(d.setCampaignNotSaved(),$('input[name="'+l+'"]').val(c),"campaign_description"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&(""===$.trim(d.removeTags(c))?(n.$preview.find(".charitable-campaign-builder-no-description-preview").removeClass("charitable-hidden"),n.$preview.find(".charitable-field-campaign-description .charitable-campaign-builder-placeholder-preview-text").html("<div></div>"),t.campaignDescription=""):(n.$preview.find(".charitable-field-campaign-description .charitable-campaign-builder-placeholder-preview-text").html("<div>"+c+"</div>"),t.campaignDescription=c),$("#charitable-panel-field-settings-campaign_description .ql-editor").html(c)),"campaign_overview"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&(""===$.trim(d.removeTags(c))?(n.$preview.find(".charitable-campaign-builder-no-overview-preview").removeClass("charitable-hidden"),n.$preview.find(".charitable-field-campaign-overview .charitable-campaign-builder-placeholder-preview-text").html("<div></div>"),t.campaignDescription=""):(n.$preview.find(".charitable-field-campaign-overview .charitable-campaign-builder-placeholder-preview-text").html("<div>"+c+"</div>"),t.campaignDescription=c),$("#charitable-panel-field-settings-campaign_overview .ql-editor").html(c)),"organizer_content"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&(p=parseInt(e.closest(".charitable-panel-field-textarea").data("field-id")),""===$.trim(d.removeTags(c))?n.$preview.find("#charitable-field-"+p+" .charitable-organizer-description").html("<div></div>"):n.$preview.find("#charitable-field-"+p+" .charitable-organizer-description").html("<div>"+c+"</div>")),"text"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&(p=parseInt(e.closest(".charitable-panel-field-textarea").data("field-id")),""===$.trim(d.removeTags(c))?n.$preview.find("#charitable-field-"+p+" .charitable-campaign-builder-placeholder-preview-text").html("<div></div>"):n.$preview.find("#charitable-field-"+p+" .charitable-campaign-builder-placeholder-preview-text").html("<div>"+c+"</div>")),!1!==a){var h=parseInt(e.find(".ql-editor").height()/2);$("#tab_"+s+"_content .placeholder.big").css("min-height",h+"px")}}))}},initSuggestedDonations:function(e){wpchar.debug(e,"initSuggestedDonations");var a=e.closest(".charitable-campaign-suggested-donations"),t=e.find("[data-charitable-add-row]"),i=(t.data("charitable-add-row"),e.find(".charitable-delete-row"));t.on("click",(function(a){a.preventDefault(),a.stopImmediatePropagation();var t=$(this).data("charitable-add-row");return"suggested-amount"===t?d.add_suggested_amount_row($(this)):"suggested-recurring-amount"===t&&d.add_suggested_amount_row($(this),"recurring"),d.initSuggestedDonations(e),!1})),i.on("click",(function(a){a.preventDefault(),a.stopImmediatePropagation();var t=$(this).closest(".charitable-campaign-suggested-donations").find("[data-charitable-add-row]").data("charitable-add-row");return"suggested-amount"===t?d.delete_suggested_amount_row($(this)):"suggested-recurring-amount"===t&&d.delete_suggested_amount_row($(this),"recurring"),d.initSuggestedDonations(e),!1})),$(".charitable-campaign-suggested-donations tbody").sortable({items:"tr:not(.to-copy)",handle:".handle",stop:function(e,a){d.reindex_rows(),$(".charitable-campaign-suggested-donations-mini").each((function(){d.updateSuggestdDonationsMiniRowsFromSettings($(this)),d.redrawDonationAmountsPreview($(this))}))}}),a.on("click","th.default_amount-col a",(function(){return a.find(".default_amount-col input").prop("checked",!1),$(this).blur(),!1})),a.on("change",'input[type="radio"]',(function(){d.redrawDonationAmountsPreview(a)}))},updateSuggestdDonationsMiniRowsFromSettings:function(e,a=0){return 0===a&&(a=e.closest(".charitable-panel-field").data("field-id")),e.find("tbody").children("tr").not(".to-copy").remove(),$("#campaign_donation_amounts tbody").children("tr").not(".no-suggested-amounts").not(".to-copy").each((function(t){var i="",l=t+1,n=$(this).find(".amount-col input").val();i=i+'<tr class="" data-index="'+l+'">',i=(i=(i=(i+='<td class="reorder-col"><span class="charitable-icon charitable-icon-donations-grab handle ui-sortable-handle"></span></td>')+'<td class="default_amount-col"><input '+($(this).find(".default_amount-col input").is(":checked")?"checked":"")+' type="radio" class="campaign_suggested_donations" name="_fields]['+a+'][donation_amounts][campaign_suggested_donations_default][]" value="'+l+'"></td>')+'<td class="amount-col"><input autocomplete="false" type="text" class="campaign_suggested_donations" name="_fields]['+a+"][donation_amounts]["+l+'][amount]" value="'+n+'" placeholder="Amount"></td>')+'<td class="description-col"><input type="text" class="campaign_suggested_donations" name="_fields]['+a+"][donation_amounts]["+l+'][description]" value="This is a small donation." placeholder="Optional Description">',i+="</td>",i+='<td class="remove-col"><span class="dashicons-before dashicons-dismiss charitable-delete-row"></span></td>',i+="</tr>",e.find("tbody").append(i)})),e},updateSuggestdDonationsRowsFromSettings:function(e,a){return void 0!==a&&0!==a.length||(a=$("#campaign_donation_amounts")),a.find("tbody").children("tr").not(".to-copy").remove(),e.children("tr").not(".no-suggested-amounts").not(".to-copy").each((function(e){var t="",i=e+1,l=$(this).find(".amount-col input").val();t=t+'<tr class="" data-index="'+i+'">',t=(t=(t=(t+='<td class="reorder-col"><span class="charitable-icon charitable-icon-donations-grab handle ui-sortable-handle"></span></td>')+'<td class="default_amount-col"><input '+($(this).find(".default_amount-col input").is(":checked")?"checked":"")+' type="radio" class="campaign_suggested_donations" name="settings][donation-options][donation_amounts][campaign_suggested_donations_default][]" value="'+i+'">')+'<td class="amount-col"><input autocomplete="off" type="text" class="campaign_suggested_donations" name="settings][donation-options][donation_amounts]['+i+'][amount]" value="'+l+'" placeholder="Amount">')+'<td class="description-col"><input type="text" class="campaign_suggested_donations" name="settings][donation-options][donation_amounts]['+i+'][description]" value="This is a small donation." placeholder="Optional Description">',t+="</td>",t+='<td class="remove-col"><span class="dashicons-before dashicons-dismiss charitable-delete-row"></span></td>',t+="</tr>",a.find("tbody").append(t)})),a},initSuggestedDonationsMini:function(e){wpchar.debug(e,"initSuggestedDonationsMini"),wpchar.debug("initSuggestedDonationsMini");var a=e.closest(".charitable-panel-field").data("field-id");wpchar.debug(e,"initSuggestedDonationsMini"),d.updateSuggestdDonationsMiniRowsFromSettings(e,a),wpchar.debug(e,"initSuggestedDonationsMini2"),d.redrawDonationAmountsPreview(e),wpchar.debug(e,"initSuggestedDonationsMini3");var t=e.closest(".charitable-campaign-suggested-donations-mini");e.find("[data-charitable-add-row]").on("click",(function(){return"suggested-amount"===$(this).data("charitable-add-row")&&(wpchar.debug("type is suggesetd amount"),wpchar.debug($(this)),d.add_suggested_amount_row($(this),"mini")),!1})),$(".charitable-campaign-suggested-donations-mini tbody").sortable({items:"tr:not(.to-copy)",handle:".handle",stop:function(e,a){wpchar.debug("sortable test mini "),d.reindex_rows("mini"),d.updateSuggestdDonationsRowsFromSettings($(this)),d.redrawDonationAmountsPreview($(this).parent())}}),t.on("click",".charitable-delete-row",(function(){return d.delete_suggested_amount_row($(this),"mini"),!1})),t.on("click","th.default_amount-col a",(function(){return t.find(".default_amount-col input").prop("checked",!1),$(this).blur(),!1})),t.on("change",'input[type="radio"]',(function(){d.redrawDonationAmountsPreview(t);var e=$(this).val();i.find(".charitable-campaign-suggested-donations-table").find('input[type="radio"]').prop("checked",!1),i.find(".charitable-campaign-suggested-donations-table").each((function(){$(this).find('input[type="radio"][value="'+e+'"]').prop("checked",!0)}))}))},add_suggested_amount_row:function(e,a=""){wpchar.debug("add_suggested_amount_row"),wpchar.debug(".charitable-campaign-suggested-donations"+a);var t="charitable-campaign-suggested-donations-table";switch(a){case"recurring":case"suggested-recurring-amount":t="charitable-campaign-suggested-recurring-donations-table"}i.find("."+t).each((function(){wpchar.debug($(this));var e=$(this).closest("table").find("tbody"),t=e.find("tr.to-copy").clone().removeClass("to-copy hidden"),i=e.find("tr:not(.to-copy)").length+1;t.attr("data-index",i);var l=t.find('.amount-col input[type="text"].campaign_suggested_donations').attr("name").replace("[0]","["+i+"]"),n=t.find('.description-col input[type="text"].campaign_suggested_donations').attr("name").replace("[0]","["+i+"]");wpchar.debug(t.find('.amount-col input[type="text"].campaign_suggested_donations')),wpchar.debug(t.find('.amount-col input[type="text"].campaign_suggested_donations').attr("name")),t.find('.amount-col input[type="text"].campaign_suggested_donations').attr("name",l),t.find('.description-col input[type="text"].campaign_suggested_donations').attr("name",n),t.find('.default_amount-col input[type="radio"]').val(i),wpchar.debug(e,"table"),wpchar.debug(t,"clone"),e.find(".no-suggested-amounts").hide(),e.append(t),t.on("click",".charitable-delete-row",(function(){return d.delete_suggested_amount_row($(this),a),!1}))})),d.redrawDonationAmountsPreview(i.find(".charitable-campaign-suggested-donations-table").first()),d.reindex_rows(a),""===a&&d.toggle_custom_donations_checkbox()},delete_suggested_amount_row:function(e,a=""){wpchar.debug("delete_suggested_amount_row"),wpchar.debug(e),wpchar.debug(a);var t=e.closest("tr "),l=parseInt(t.attr("data-index")),n="charitable-campaign-suggested-donations-table";switch(a){case"recurring":case"suggested-recurring-amount":n="charitable-campaign-suggested-recurring-donations-table"}wpchar.debug(t),wpchar.debug(l,"row_to_delete_index"),l>0&&(wpchar.debug($('.charitable-campaign-suggested-donations-table tbody tr[data-index="'+l+'"]')),wpchar.debug('.charitable-campaign-suggested-donations-table tbody tr[data-index="'+l+'"]'),i.find("."+n).each((function(){$(this).find('tbody tr[data-index="'+l+'"]').remove()}))),d.redrawDonationAmountsPreview(i.find(".charitable-campaign-suggested-donations-table").first());var r=e.closest("table").find("tbody");1==r.find("tr:not(.to-copy)").length&&r.find(".no-suggested-amounts").removeClass("hidden").show(),d.reindex_rows(a),""===a?d.reindex_rows("mini"):"mini"===a&&d.reindex_rows(),""===a&&d.toggle_custom_donations_checkbox()},reindex_rows:function(e=""){wpchar.debug("reindex rows with type: "+e),""!==e&&(e="-"+e),$(".charitable-campaign-suggested-donations"+e+" tbody").each((function(){$(this).children("tr").not(".no-suggested-amounts .to-copy").each((function(e){$(this).find('input[type="radio"]').val(e),$(this).attr("data-index",e),$(this).find("input").each((function(a){this.name=this.name.replace(/(\[\d\])/,"["+e+"]")}))}))}))},redrawDonationAmountsPreview:function(e){n.$preview.find("ul.charitable-preview-donation-amounts").each((function(a){var t=$(this);t.find("li").remove(),$(e).find("tbody").children("tr").not(".no-suggested-amounts").not(".to-copy").not("hidden").each((function(e){var a=$(this).find('input[type="text"].campaign_suggested_donations').first().val(),i="";wpchar.debug($(this).find('input[type="radio"]')),$(this).find('input[type="radio"]').is(":checked")&&(i=" selected"),
t.append('<li class="charitable-preview-donation-amount suggested-donation-amount'+i+'"><label><input type="radio" name="donation_amount" value="'+e+'"><span class="amount">'+a+"</span></label></li>")})),$("#charitable-panel-field-settings-campaign_allow_custom_donations").is(":checked")&&t.append('<li class="charitable-preview-donation-amount custom-donation-amount "><span class="custom-donation-amount-wrapper"><label><input type="radio" name="donation_amount" value="custom"><span class="description">Custom amount</span></label><input type="text" disabled="&quot;true&quot;" class="custom-donation-input" name="custom_donation_amount" placeholder="Custom Donation Amount" value=""></span></li>')}))},toggle_custom_donations_checkbox:function(){var e=$("#campaign_allow_custom_donations"),a=$(".charitable-campaign-suggested-donations tbody tr:not(.to-copy)"),t=a.length>1||!1===a.first().hasClass("no-suggested-amounts");e.prop("disabled",!t),t||e.prop("checked",!0)},initTagField:function(e){e.select2()},initColorPicker:function(){Coloris({el:".coloris"}),Coloris.setInstance(".instance2.primary",{defaultColor:t.primaryThemeColor,onChange:function(a){""===a?($('input[name="layout__advanced__theme_color_primary"]').val(t.primaryThemeColorBase),t.primaryThemeColor=t.primaryThemeColorBase,e.querySelector('input[name="layout__advanced__theme_color_primary"]').dispatchEvent(new Event("input",{bubbles:!0}))):t.primaryThemeColor=a,d.updateThemeCSS("primary",t.templateID,t.primaryThemeColor,t.secondaryThemeColor,t.tertiaryThemeColor,t.buttonThemeColor,!0)},theme:"polaroid",themeMode:"light",alpha:!1,formatToggle:!0,closeButton:!0,clearButton:!0,clearLabel:"Reset",swatches:["#067bc2","#84bcda","#80e377","#ecc30b","#f37748","#d56062"]}),Coloris.setInstance(".instance2.secondary",{defaultColor:t.secondaryThemeColor,onChange:function(a){""===a?($('input[name="layout__advanced__theme_color_secondary"]').val(t.secondaryThemeColorBase),t.secondaryThemeColor=t.secondaryThemeColorBase,d.updateThemeCSS("secondary",t.templateID,t.primaryThemeColor,t.secondaryThemeColor,t.tertiaryThemeColor,t.buttonThemeColor,!0),e.querySelector('input[name="layout__advanced__theme_color_secondary"]').dispatchEvent(new Event("input",{bubbles:!0}))):(t.secondaryThemeColor=a,d.updateThemeCSS("secondary",t.templateID,t.primaryThemeColor,t.secondaryThemeColor,t.tertiaryThemeColor,t.buttonThemeColor,!0))},theme:"polaroid",themeMode:"light",alpha:!1,formatToggle:!0,closeButton:!0,clearButton:!0,clearLabel:"Reset",swatches:["#067bc2","#84bcda","#80e377","#ecc30b","#f37748","#d56062"]}),Coloris.setInstance(".instance2.tertiary",{defaultColor:t.tertiaryThemeColor,onChange:function(a){""===a?($('input[name="layout__advanced__theme_color_tertiary"]').val(t.tertiaryThemeColorBase),t.tertiaryThemeColor=t.tertiaryThemeColorBase,d.updateThemeCSS("teritary",t.templateID,t.primaryThemeColor,t.secondaryThemeColor,t.tertiaryThemeColor,t.buttonThemeColor,!0),e.querySelector('input[name="layout__advanced__theme_color_tertiary"]').dispatchEvent(new Event("input",{bubbles:!0}))):(t.tertiaryThemeColor=a,d.updateThemeCSS("teritary",t.templateID,t.primaryThemeColor,t.secondaryThemeColor,t.tertiaryThemeColor,t.buttonThemeColor,!0))},theme:"polaroid",themeMode:"light",alpha:!1,formatToggle:!0,closeButton:!0,clearButton:!0,clearLabel:"Reset",swatches:["#067bc2","#84bcda","#80e377","#ecc30b","#f37748","#d56062"]}),Coloris.setInstance(".instance2.button-color",{defaultColor:t.buttonThemeColor,onChange:function(a){""===a?($('input[name="layout__advanced__theme_color_button"]').val(t.buttonThemeColorBase),t.buttonThemeColor=t.buttonThemeColorBase,d.updateThemeCSS("button",t.templateID,t.primaryThemeColor,t.secondaryThemeColor,t.tertiaryThemeColor,t.buttonThemeColor,!0),e.querySelector('input[name="layout__advanced__theme_color_button"]').dispatchEvent(new Event("input",{bubbles:!0}))):(t.buttonThemeColor=a,d.updateThemeCSS("button",t.templateID,t.primaryThemeColor,t.secondaryThemeColor,t.tertiaryThemeColor,t.buttonThemeColor,!0))},theme:"polaroid",themeMode:"light",alpha:!1,formatToggle:!0,closeButton:!0,clearButton:!0,clearLabel:"Reset",swatches:["#067bc2","#84bcda","#80e377","#ecc30b","#f37748","#d56062"]}),n.$fieldOptions.on("click",".clr-field button",(function(e){e.preventDefault(),$(this).parent().find('input[type="text"]').trigger("click")}))},initDatePicker:function(e){var a=e,t={dateFormat:a.data("format")||"MM d, yy",minDate:a.data("min-date")||"",beforeShow:function(e,a){setTimeout((function(){$(".ui-datepicker").css("z-index",99999999999999)}),0)}};$.isFunction(a.datepicker)&&(a.datepicker(t),a.data("date")&&a.datepicker("setDate",this.$el.data("date")),a.data("min-date")&&a.datepicker("option","minDate",this.$el.data("min-date")))},trimFormTitle:function(){var e=$(".charitable-center-form-name");if(e.text().length>38){var a=e.text().trim().substring(0,38).split(" ").slice(0,-1).join(" ")+"...";e.text(a)}},builderHotkeys:function(){hotkeys("esc,ctrl+1,ctrl+2,ctrl+3,ctrl+4,ctrl+5,ctrl+s,ctrl+p,ctrl+x,ctrl+v",(function(e,a){switch(a.key){case"esc":$(".charitable-builder-modal.charitable-builder-modal-template-preview").hasClass("active")&&($(".charitable-template-list-container").removeClass("disabled"),$("#charitable-builder-underlay").remove(),$(".charitable-builder-modal.charitable-builder-modal-template-preview").removeClass("active"));break;case"ctrl+1":$(n.$templateButton,i).trigger("click");break;case"ctrl+2":$(n.$designButton,i).trigger("click");break;case"ctrl+3":$(n.$settingsButton,i).trigger("click");break;case"ctrl+4":$(n.$marketingButton,i).trigger("click");break;case"ctrl+5":$(n.$paymentButton,i).trigger("click");break;case"ctrl+s":$(n.$saveButton,i).trigger("click");break;case"ctrl+p":$(n.$previewButton,i).trigger("click");break;case"ctrl+x":$(n.$exitButton,i).trigger("click");break;case"ctrl+v":$(n.$viewCampaignButton,i).trigger("click")}}))},openModalButtonClick:function(){$(e).on("click",".charitable-not-available:not(.charitable-add-fields-button)",d.openModalButtonHandler).on("mousedown",".charitable-not-available.charitable-add-fields-button",d.openModalButtonHandler),$(e).on("click",".charitable-disabled-modal:not(.charitable-add-fields-button)",d.openModalWarningModal).on("mousedown",".charitable-add-fields-button.charitable-disabled-modal",d.openModalWarningModal),$(e).on("click",".charitable-disabled-same_page:not(.charitable-add-fields-button)",d.openModalWarningModal).on("mousedown",".charitable-add-fields-button.charitable-disabled-same_page",d.openModalWarningModal),$(e).on("click",".charitable-not-installed:not(.charitable-add-fields-button)",d.openModalButtonHandlerInstall).on("mousedown",".charitable-not-installed.charitable-add-fields-button",d.openModalButtonHandlerInstall),$(e).on("click",".charitable-not-activated:not(.charitable-add-fields-button)",d.openModalButtonHandlerActivate).on("mousedown",".charitable-not-activated.charitable-add-fields-button",d.openModalButtonHandlerActivate),$(e).on("click",".charitable-addon-file-missing:not(.charitable-add-fields-button)",d.openModalButtonHandlerInstall).on("mousedown",".charitable-addon-file-missing.charitable-add-fields-button",d.openModalButtonHandlerInstall),$(e).on("click",".charitable-not-available:not(.charitable-setting-panel-upgrade-to-pro)",d.openModalButtonHandler).on("mousedown",".charitable-not-available.charitable-setting-panel-upgrade-to-pro",d.openModalButtonHandler),$(e).on("click",".charitable-need-upgrade:not(.charitable-setting-panel-upgrade-to-pro)",d.openModalButtonHandler).on("mousedown",".charitable-need-upgrade.charitable-setting-panel-upgrade-to-pro",d.openModalButtonHandler),$(e).on("click",".charitable-installed-refresh:not(.charitable-add-fields-button)",d.openModalButtonHandlerActivatedRefresh).on("mousedown",".charitable-installed-refresh.charitable-add-fields-button",d.openModalButtonHandlerActivatedRefresh),$(e).on("click","a.button-link.charitable-not-activated",d.openModalButtonHandlerActivate).on("mousedown","a.button-link.charitable-not-activated",d.openModalButtonHandlerActivate),$(e).on("click","a.button-link.charitable-not-installed",d.openModalButtonHandlerInstall).on("mousedown","a.button-link.charitable-not-installed",d.openModalButtonHandlerInstall)},openModalWarningModal:function(e){const a=$(this);e.preventDefault(),e.stopImmediatePropagation();let t=a.data("name"),i="",l="";a.hasClass("charitable-add-fields-button")&&(t=a.text(),t+=t.indexOf(charitable_builder.field)<0?" "+charitable_builder.field:"",a.data("field-icon")&&(i=a.data("field-icon"))),a.hasClass("charitable-disabled-modal")?l="modal":a.hasClass("charitable-disabled-same_page")&&(l="same_page"),d.modalWarningModal(t,l,i)},openModalButtonHandlerInstall:function(e){const a=$(this);var t="",i="",l="",n="";if(a.data("action")&&["activate","install"].includes(a.data("action")))return;e.preventDefault(),e.stopImmediatePropagation();let r=a.data("name");a.hasClass("charitable-add-fields-button")&&(r=a.text(),r+=r.indexOf(charitable_builder.field)<0?" "+charitable_builder.field:"",a.data("field-icon")&&(t=a.data("field-icon"))),a.data("install")&&(i=a.data("install")),a.data("plugin-url")&&(i=a.data("plugin-url")),a.data("video")&&(l=a.data("video")),a.data("license")&&(n=a.data("license")),d.installModal(r,i,n,l,a,!1,t)},openModalButtonHandlerActivatedRefresh:function(e){const a=$(this);e.preventDefault(),e.stopImmediatePropagation();let t=a.data("name");d.activateRefreshModal(t,a.data("video"))},openModalButtonHandlerActivate:function(e){const a=$(this);var t="",i="",l="";if(a.data("action")&&["activate","install"].includes(a.data("action")))return;e.preventDefault(),e.stopImmediatePropagation();let n=a.data("name");a.data("plugin-url")&&(t=a.data("plugin-url")),a.data("video")&&(i=a.data("video")),a.data("license")&&(l=a.data("license")),d.activateModal(n,t,l,i,a,!1,"")},openModalButtonHandler:function(e){const a=$(this);if(a.data("action")&&["activate","install"].includes(a.data("action")))return;e.preventDefault(),e.stopImmediatePropagation();let t="",i=a.data("name"),l=a.data("type");a.hasClass("charitable-add-fields-button")&&(i=a.text(),i+=i.indexOf(charitable_builder.field)<0?" "+charitable_builder.field:"",a.data("field-icon")&&(t=a.data("field-icon")));d.upgradeModal(i,"utmValue",a.data("license"),a.data("video"),l,t)},modalWarningModal:function(e,t="",i=""){var l="",n=d.getUpgradeModalWidth(!1);"modal"===t?l=charitable_builder.field_disabled_due_to_modal.replace(/%name%/g,e):"same_page"===t&&(l=charitable_builder.field_disabled_due_to_same_page.replace(/%name%/g,e));$.alert({backgroundDismiss:!0,title:"",icon:""!==i?"fa "+i:"fa fa-thumbs-up",content:l,boxWidth:n,theme:"modern,charitable-install-form",closeIcon:!0,buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){}},cancel:{text:charitable_builder.go_to_settings,btnClass:"btn-confirm",action:function(){a.open(charitable_builder.settings_page_url)}}}})},setAddonState:function(e,a,t,i,l,n,r){wpchar.debug("setAddonState"),wpchar.debug(e),wpchar.debug(a),wpchar.debug(t);var o={activate:"charitable_activate_addon",install:"charitable_install_addon",deactivate:"charitable_deactivate_addon"}[t];if(o){var d={action:o,nonce:charitable_admin.nonce,plugin:e,type:i};wpchar.debug(d),$.post(charitable_admin.ajax_url,d,(function(i){r(i,e,a,t,l,n)})).fail((function(e){wpchar.debug(e.responseText)}))}},callBackAddonState:function(e,a="",i="",l="",n=!1,r){wpchar.debug("callBackAddonState"),wpchar.debug(e),wpchar.debug(l),wpchar.debug(n);var o="";e.success?"install"===l?(wpchar.debug("installed"),!1!==t.currentModal&&"object"==typeof t.currentModal&&t.currentModal.close(),e.data.is_activated?(o=e.data.msg,d.upgradeModalAddonInstalledAndActivated(a,i,o)):d.upgradeModalAddonInstalledAndActivatedFailed(a,i,o)):"activate"===l?(wpchar.debug("activated"),o=e.data,!1!==t.currentModal&&"object"==typeof t.currentModal&&t.currentModal.close(),d.upgradeModalAddonActivated(a,i,o),r.addClass("charitable-installed-refresh").removeClass("charitable-not-activated"),d.openModalButtonClick()):(wpchar.debug("some other success"),o=e.data,!1!==t.currentModal&&"object"==typeof t.currentModal&&t.currentModal.close(),d.upgradeModalAddonActivated(a,i,o),r.addClass("charitable-installed-refresh").removeClass("charitable-not-activated"),d.openModalButtonClick()):(!1!==t.currentModal&&"object"==typeof t.currentModal&&t.currentModal.close(),d.upgradeModalAddonActivatedFailed(a,i,o))},activateRefreshModal:function(e,t,i=""){wpchar.debug("activateRefreshModal"),wpchar.debug(e),wpchar.debug(t);var l=charitable_builder.activated_refresh.replace(/%addon%/g,e),n=!_.isEmpty(t),r=d.getUpgradeModalWidth(n),o='<span class="charitable-upgrade-pro-title">'+e+" "+charitable_builder.activated_refresh_title+"</span>",c=$.alert({backgroundDismiss:!0,title:o,icon:""!==i?"fa "+i:"fa fa-thumbs-up",content:l,boxWidth:r,theme:"modern,charitable-activate-refresh",closeIcon:!0,buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}});$(a).on("resize",(function(){r=d.getUpgradeModalWidth(n),c.isOpen()&&c.setBoxWidth(r)}))},activateModal:function(e,i,l,n,r,o=!1,c=""){wpchar.debug("activatelModal"),wpchar.debug(e),wpchar.debug(i),wpchar.debug(l),wpchar.debug(n),wpchar.debug(o),void 0!==l&&0!==l.length||(l="pro");var s=charitable_builder.activate.message.replace(/%addon%/g,e),p=!_.isEmpty(n),h=d.getUpgradeModalWidth(p),b='<span class="charitable-upgrade-pro-title">'+e+" "+charitable_builder.activate.title+"</span>",u=$.alert({backgroundDismiss:!0,title:b,icon:""!==c?"fa "+c:"fa fa-thumbs-up",content:s,boxWidth:h,theme:"modern,charitable-activate-addon",closeIcon:!0,buttons:{cancel:{btnClass:"btn-confirm",keys:["esc"],isHidden:!1,isDisabled:!1,action:function(){}},install:{text:charitable_builder.activate.button,btnClass:"btn-confirm",keys:["enter"],isHidden:!1,isDisabled:!1,action:function(a){return a.setText(charitable_builder.activating),a.disable(),this.$$cancel.prop("disabled",!0),this.$$cancel.hide(),d.setAddonState(i,e,"activate","addon",$(this),r,d.callBackAddonState),!1}}}});t.currentModal=u,$(a).on("resize",(function(){h=d.getUpgradeModalWidth(p),u.isOpen()&&u.setBoxWidth(h)}))},installModal:function(e,i,l,n,r,o=!1,c=""){if(wpchar.debug("installModal"),wpchar.debug(e),wpchar.debug(i),wpchar.debug(l),wpchar.debug(n),wpchar.debug(r),wpchar.debug(o),void 0!==l&&0!==l.length||(l="pro"),!($.inArray(l,["pro","basic","plus","agency","elite"])<0)){var s=charitable_builder.charitable_license_label,p=charitable_builder.install[l].message.replace(/%name%/g,s).replace(/%addon%/g,e),h=!_.isEmpty(n),b=d.getUpgradeModalWidth(h),u="";u=o?'<span class="charitable-upgrade-pro-title">'+e+" "+charitable_builder.install["pro-panel"].title+"</span>":'<span class="charitable-upgrade-pro-title">'+e+" "+charitable_builder.install[l].title+"</span>";var m=$.alert({backgroundDismiss:!1,title:u,icon:""!==c?"fa "+c:"fa fa-thumbs-up",content:p,boxWidth:b,theme:"modern,charitable-install-form",closeIcon:!1,buttons:{cancel:{btnClass:"btn-confirm",keys:["esc"],isHidden:!1,isDisabled:!1,action:function(){}},confirmInstall:{text:charitable_builder.install[l].button,btnClass:"btn-confirm",keys:["enter"],isHidden:!1,isDisabled:!1,action:function(a){return a.setText(charitable_builder.installing),a.disable(),this.$$cancel.prop("disabled",!0),this.$$cancel.hide(),d.setAddonState(i,e,"install","addon",$(this),r,d.callBackAddonState),!1}}}});t.currentModal=m,$(a).on("resize",(function(){b=d.getUpgradeModalWidth(h),m.isOpen()&&m.setBoxWidth(b)}))}},upgradeModal:function(e,t,i,l,n=!1,r=""){if(void 0!==i&&0!==i.length||(i="pro"),!($.inArray(i,["pro","basic","plus","agency","elite"])<0)){var o=!_.isEmpty(l),c=d.getUpgradeModalWidth(o),s="",p="",h="",b="pro"!==i.toLowerCase()?i.charAt(0).toUpperCase()+i.slice(1):"PRO";n?(s=e+" "+charitable_builder.upgrade["pro-panel"].title.replace(/%plan%/g,b),p=(p=charitable_builder.upgrade["pro-panel"].message.replace(/%name%/g,e)).replace(/%plan%/g,b),h=(h=charitable_builder.upgrade["pro-panel"].button.replace(/%name%/g,e).replace("addon","")).replace(/%plan%/g,b)):(s=e+" "+charitable_builder.upgrade[i].title.replace(/%plan%/g,b),p=(p=charitable_builder.upgrade[i].message.replace(/%name%/g,e)).replace(/%plan%/g,b),h=(h=charitable_builder.upgrade[i].button.replace(/%name%/g,e).replace("addon","")).replace(/%plan%/g,b));var u=$.alert({backgroundDismiss:!0,title:s,icon:""!==r?"fa "+r:"fa fa-lock",content:p,boxWidth:c,theme:"modern,charitable-upgrade-form-lite",closeIcon:!0,onOpenBefore:function(){o&&this.$el.addClass("has-video");var a=o?'<iframe src="'+l+'" class="feature-video" frameborder="0" allowfullscreen="" width="475" height="267"></iframe>':"";this.$btnc.after(charitable_builder.upgrade[i].doc.replace(/%25name%25/g,e)),this.$btnc.after(a),this.$body.find(".jconfirm-content").addClass("lite-upgrade")},buttons:{confirm:{text:h,btnClass:"btn-confirm",keys:["enter"],action:function(){a.open(d.getUpgradeURL(t,i),"_blank"),d.upgradeModalThankYou(i)}}}});$(a).on("resize",(function(){c=d.getUpgradeModalWidth(o),u.isOpen()&&u.setBoxWidth(c)}))}},getInstallURL:function(e,a,t=!1){var i=charitable_builder.charitable_addons_page;return t&&(i=i+"&search="+t.replace(/[^0-9a-z+ ]/gi,"").replace("Field","").trim()),i},getUpgradeURL:function(e,a){var t=charitable_builder.upgrade[a].url;e.toLowerCase().indexOf("template")>-1&&(t=charitable_builder.upgrade[a].url_template);var i=/(\?)/.test(t)?"&":"?";return-1===t.indexOf("https://wpcharitable.com")&&(i=encodeURIComponent(i)),t+i+"utm_content="+encodeURIComponent(e.trim())},upgradeModalThankYou:function(e){$.alert({title:charitable_builder.thanks_for_interest,content:charitable_builder.upgrade[e].modal,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},upgradeModalAddonInstalledAndActivated:function(e="",a="",t=""){$.alert({title:'<span class="charitable-upgrade-pro-title">'+a+" "+charitable_builder.installed_activated_title+"</span>",content:charitable_builder.installed_activated_reboot,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["esc"]},saveRefresh:{text:charitable_builder.save_refresh,btnClass:"btn-confirm",keys:["enter"],action:function(e){return e.setText(charitable_builder.standby),e.disable(),this.$$confirm.prop("disabled",!0),this.$$confirm.hide(),d.formSave(!1,!1,!1,!0),!1}}}})},upgradeModalAddonActivated:function(e="",a="",t=""){$.alert({title:'<span class="charitable-upgrade-pro-title">'+a+" "+charitable_builder.activated_title+"</span>",content:charitable_builder.activated_reboot,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["esc"]},saveRefresh:{text:charitable_builder.save_refresh,btnClass:"btn-confirm",keys:["enter"],action:function(e){return e.setText(charitable_builder.standby),e.disable(),this.$$confirm.prop("disabled",!0),this.$$confirm.hide(),d.formSave(!1,!1,!1,!0),!1}}}})},upgradeModalAddonInstalledAndActivatedFailed:function(e="",a="",t=""){$.alert({title:'<span class="charitable-upgrade-pro-title">'+a+" "+charitable_builder.installed_activated_failed_title+"</span>",content:charitable_builder.installed_activated_failed_reboot,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},upgradeModalAddonActivatedFailed:function(e="",a="",t=""){$.alert({title:'<span class="charitable-upgrade-pro-title">'+a+" "+charitable_builder.activated_failed_title+"</span>",content:charitable_builder.activated_failed_reboot,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},getUpgradeModalWidth:function(e){var t=$(a).width();return t<=300?"250px":t<=750?"350px":!e||t<=1024?"560px":t>1070?"1040px":"994px"},isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)}};return d}(document,window,jQuery);CharitableCampaignBuilder.init();